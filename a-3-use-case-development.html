<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Use Case Development Workflow - SIEM Mastery Guide</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <div class="page-wrapper">
        <button class="mobile-menu-toggle" aria-label="Toggle navigation menu">
            <div class="hamburger"><span></span><span></span><span></span></div>
        </button>
        <div class="sidebar-overlay"></div>
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="logo-icon">ğŸ›¡ï¸</div>
                    <div>
                        <div class="logo-text">SIEM Mastery</div>
                        <div class="logo-subtext">Complete Guide</div>
                    </div>
                </a>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-header"><span class="nav-section-title"><span class="nav-section-icon">ğŸ“š</span>SIEM Fundamentals</span><span class="nav-section-arrow">â€º</span></div>
                    <div class="nav-section-items">
                        <a href="1-1-introduction-to-siem.html" class="nav-item">1.1 Introduction to SIEM</a>
                        <a href="1-2-architecture-components.html" class="nav-item">1.2 Architecture & Components</a>
                        <a href="1-3-log-sources-onboarding.html" class="nav-item">1.3 Log Sources & Onboarding</a>
                        <a href="1-4-log-parsing-normalization.html" class="nav-item">1.4 Log Parsing & Normalization</a>
                        <a href="1-5-detection-engineering-fundamentals.html" class="nav-item">1.5 Detection Engineering</a>
                        <a href="1-6-soc-operations-siem.html" class="nav-item">1.6 SOC Operations & SIEM</a>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-header"><span class="nav-section-title"><span class="nav-section-icon">ğŸŸ¢</span>Splunk Fundamentals</span><span class="nav-section-arrow">â€º</span></div>
                    <div class="nav-section-items">
                        <a href="2-1-splunk-architecture.html" class="nav-item">2.1 Splunk Architecture</a>
                        <a href="2-2-installation-configuration.html" class="nav-item">2.2 Installation & Config</a>
                        <a href="2-3-data-ingestion.html" class="nav-item">2.3 Data Ingestion</a>
                        <a href="2-4-index-management.html" class="nav-item">2.4 Index Management</a>
                        <a href="2-5-spl-fundamentals.html" class="nav-item">2.5 SPL Fundamentals</a>
                        <a href="2-6-spl-data-retrieval.html" class="nav-item">2.6 SPL Data Retrieval</a>
                        <a href="2-7-spl-transforming.html" class="nav-item">2.7 SPL Transforming</a>
                        <a href="2-8-spl-manipulation.html" class="nav-item">2.8 SPL Manipulation</a>
                        <a href="2-9-spl-advanced.html" class="nav-item">2.9 SPL Advanced</a>
                        <a href="2-10-search-optimization.html" class="nav-item">2.10 Search Optimization</a>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-header"><span class="nav-section-title"><span class="nav-section-icon">ğŸ”’</span>Splunk Security Ops</span><span class="nav-section-arrow">â€º</span></div>
                    <div class="nav-section-items">
                        <a href="3-1-splunk-es-overview.html" class="nav-item">3.1 ES Overview</a>
                        <a href="3-2-notable-events.html" class="nav-item">3.2 Notable Events</a>
                        <a href="3-3-correlation-searches.html" class="nav-item">3.3 Correlation Searches</a>
                        <a href="3-4-risk-based-alerting.html" class="nav-item">3.4 Risk-Based Alerting</a>
                        <a href="3-5-threat-intelligence.html" class="nav-item">3.5 Threat Intelligence</a>
                        <a href="3-6-asset-identity.html" class="nav-item">3.6 Asset & Identity</a>
                        <a href="3-7-security-dashboards.html" class="nav-item">3.7 Security Dashboards</a>
                        <a href="3-8-es-administration.html" class="nav-item">3.8 ES Administration</a>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-header"><span class="nav-section-title"><span class="nav-section-icon">âš¡</span>Splunk SOAR</span><span class="nav-section-arrow">â€º</span></div>
                    <div class="nav-section-items">
                        <a href="4-1-soar-overview.html" class="nav-item">4.1 SOAR Overview</a>
                        <a href="4-2-playbooks.html" class="nav-item">4.2 Playbooks</a>
                        <a href="4-3-apps-integrations.html" class="nav-item">4.3 Apps & Integrations</a>
                        <a href="4-4-case-management.html" class="nav-item">4.4 Case Management</a>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-header"><span class="nav-section-title"><span class="nav-section-icon">ğŸ”·</span>Sentinel Fundamentals</span><span class="nav-section-arrow">â€º</span></div>
                    <div class="nav-section-items">
                        <a href="5-1-sentinel-architecture.html" class="nav-item">5.1 Sentinel Architecture</a>
                        <a href="5-2-log-analytics.html" class="nav-item">5.2 Log Analytics</a>
                        <a href="5-3-data-connectors.html" class="nav-item">5.3 Data Connectors</a>
                        <a href="5-4-kql-fundamentals.html" class="nav-item">5.4 KQL Fundamentals</a>
                        <a href="5-5-kql-advanced.html" class="nav-item">5.5 KQL Advanced</a>
                        <a href="5-6-analytics-rules.html" class="nav-item">5.6 Analytics Rules</a>
                        <a href="5-7-incidents-investigation.html" class="nav-item">5.7 Incidents & Investigation</a>
                        <a href="5-8-workbooks-reporting.html" class="nav-item">5.8 Workbooks & Reporting</a>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-header"><span class="nav-section-title"><span class="nav-section-icon">ğŸ”¶</span>Sentinel Security Ops</span><span class="nav-section-arrow">â€º</span></div>
                    <div class="nav-section-items">
                        <a href="6-1-automation-playbooks.html" class="nav-item">6.1 Automation & Playbooks</a>
                        <a href="6-2-watchlists-ti.html" class="nav-item">6.2 Watchlists & TI</a>
                        <a href="6-3-ueba.html" class="nav-item">6.3 UEBA</a>
                        <a href="6-4-sentinel-administration.html" class="nav-item">6.4 Administration</a>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-header"><span class="nav-section-title"><span class="nav-section-icon">âš–ï¸</span>SIEM Comparison</span><span class="nav-section-arrow">â€º</span></div>
                    <div class="nav-section-items">
                        <a href="7-1-splunk-vs-sentinel.html" class="nav-item">7.1 Splunk vs Sentinel</a>
                        <a href="7-2-query-language-comparison.html" class="nav-item">7.2 SPL vs KQL</a>
                        <a href="7-3-migration-considerations.html" class="nav-item">7.3 Migration Basics</a>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-header"><span class="nav-section-title"><span class="nav-section-icon">ğŸ¯</span>Detection Engineering</span><span class="nav-section-arrow">â€º</span></div>
                    <div class="nav-section-items">
                        <a href="8-1-detection-development.html" class="nav-item">8.1 Detection Development</a>
                        <a href="8-2-mitre-attack.html" class="nav-item">8.2 MITRE ATT&CK</a>
                        <a href="8-3-sigma-rules.html" class="nav-item">8.3 Sigma Rules</a>
                        <a href="8-4-detection-testing.html" class="nav-item">8.4 Detection Testing</a>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-header"><span class="nav-section-title"><span class="nav-section-icon">ğŸ”</span>Threat Hunting</span><span class="nav-section-arrow">â€º</span></div>
                    <div class="nav-section-items">
                        <a href="9-1-hunting-fundamentals.html" class="nav-item">9.1 Hunting Fundamentals</a>
                        <a href="9-2-hunting-methodologies.html" class="nav-item">9.2 Methodologies</a>
                        <a href="9-3-hunting-queries.html" class="nav-item">9.3 Hunting Queries</a>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-header"><span class="nav-section-title"><span class="nav-section-icon">ğŸ“‹</span>Use Cases</span><span class="nav-section-arrow">â€º</span></div>
                    <div class="nav-section-items">
                        <a href="10-1-authentication-attacks.html" class="nav-item">10.1 Authentication Attacks</a>
                        <a href="10-2-malware-execution.html" class="nav-item">10.2 Malware Execution</a>
                        <a href="10-3-data-exfiltration.html" class="nav-item">10.3 Data Exfiltration</a>
                        <a href="10-4-insider-threats.html" class="nav-item">10.4 Insider Threats</a>
                    </div>
                </div>
                <div class="nav-section expanded">
                    <div class="nav-section-header"><span class="nav-section-title"><span class="nav-section-icon">ğŸ“–</span>Appendices</span><span class="nav-section-arrow">â€º</span></div>
                    <div class="nav-section-items">
                        <a href="a-1-windows-security-fundamentals.html" class="nav-item ">A.1 Windows Security</a>
                        <a href="a-2-network-fundamentals.html" class="nav-item">A.2 Network Fundamentals</a>
                        <a href="a-3-use-case-development.html" class="nav-item">A.3 Use Case Development</a>
                        <a href="a-4-siem-migration-guide.html" class="nav-item">A.4 SIEM Migration Guide</a>
                        <a href="a-5-siem-design-from-scratch.html" class="nav-item">A.5 Design from Scratch</a>
                    </div>
                </div>
            </nav>
        </aside>


        <main class="main-content">
            <header class="content-header">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">Use Case Development Workflow</span>
                </nav>
            </header>
            
            <div class="content-area">
                <h1 class="page-title">Use Case Development Workflow</h1>
                <p class="page-subtitle">From security requirements to production detection rules - the complete process</p>
                
                <div class="info-box overview">
                    <div class="info-box-header">
                        <span class="info-box-icon">ğŸ“˜</span>
                        Chapter Overview
                    </div>
                    <div class="info-box-content">
                        <p>
                            This appendix covers the complete workflow for developing SIEM use cases: gathering requirements from stakeholders, translating them into detection logic, mapping to specific log sources and events, implementing rules, and validating effectiveness. This is a critical skill for SIEM engineers.
                        </p>
                    </div>
                </div>

                <h2 id="development-lifecycle">Use Case Development Lifecycle</h2>
                
                <div class="workflow-diagram">
                    <div class="workflow-title">Complete Use Case Development Workflow</div>
                    <div class="workflow-container">
                        <pre class="diagram-ascii">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USE CASE DEVELOPMENT LIFECYCLE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚    1    â”‚     â”‚    2    â”‚     â”‚    3    â”‚     â”‚    4    â”‚     â”‚    5    â”‚  â”‚
â”‚   â”‚ REQUIRE â”‚â”€â”€â”€â”€â–¶â”‚  DATA   â”‚â”€â”€â”€â”€â–¶â”‚ DESIGN  â”‚â”€â”€â”€â”€â–¶â”‚ IMPLEM- â”‚â”€â”€â”€â”€â–¶â”‚  TEST   â”‚  â”‚
â”‚   â”‚ -MENTS  â”‚     â”‚ MAPPING â”‚     â”‚  LOGIC  â”‚     â”‚  ENT    â”‚     â”‚ VALIDATEâ”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚               â”‚               â”‚               â”‚               â”‚        â”‚
â”‚        â–¼               â–¼               â–¼               â–¼               â–¼        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚â€¢ Threat â”‚     â”‚â€¢ Log    â”‚     â”‚â€¢ Detect â”‚     â”‚â€¢ SPL/   â”‚     â”‚â€¢ Atomic â”‚  â”‚
â”‚   â”‚  Model  â”‚     â”‚  Sourcesâ”‚     â”‚  Patternâ”‚     â”‚  KQL    â”‚     â”‚  Red    â”‚  â”‚
â”‚   â”‚â€¢ Businessâ”‚    â”‚â€¢ Event  â”‚     â”‚â€¢ Thresh-â”‚     â”‚â€¢ Alert  â”‚     â”‚  Team   â”‚  â”‚
â”‚   â”‚  Contextâ”‚     â”‚  IDs    â”‚     â”‚  olds   â”‚     â”‚  Config â”‚     â”‚â€¢ Purple â”‚  â”‚
â”‚   â”‚â€¢ MITRE  â”‚     â”‚â€¢ Fields â”‚     â”‚â€¢ False  â”‚     â”‚â€¢ Play-  â”‚     â”‚  Team   â”‚  â”‚
â”‚   â”‚  Mappingâ”‚     â”‚â€¢ Gaps   â”‚     â”‚  Positivâ”‚     â”‚  book   â”‚     â”‚â€¢ Tune   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                               â”‚        â”‚
â”‚        â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚        â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    6     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                  â”‚ MAINTAIN â”‚                                   â”‚
â”‚                                  â”‚ & TUNE   â”‚                                   â”‚
â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚                              â”‚â€¢ Monitor FP/FN  â”‚                                â”‚
â”‚                              â”‚â€¢ Update for new â”‚                                â”‚
â”‚                              â”‚  threats        â”‚                                â”‚
â”‚                              â”‚â€¢ Retire obsoleteâ”‚                                â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </pre>
                    </div>
                </div>

                <h2 id="requirements-gathering">Phase 1: Requirements Gathering</h2>
                
                <h3>Sources of Detection Requirements</h3>
                
                <div class="workflow-diagram">
                    <div class="workflow-title">Security Requirements Sources</div>
                    <div class="workflow-container">
                        <pre class="diagram-ascii">
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   DETECTION NEED       â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚               â”‚               â”‚               â”‚               â”‚
          â–¼               â–¼               â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  THREAT   â”‚   â”‚ COMPLIANCEâ”‚   â”‚  INCIDENT â”‚   â”‚  BUSINESS â”‚   â”‚  THREAT   â”‚
    â”‚  INTEL    â”‚   â”‚ REQUIRE-  â”‚   â”‚  LESSONS  â”‚   â”‚  REQUIRE- â”‚   â”‚  MODELING â”‚
    â”‚           â”‚   â”‚  MENTS    â”‚   â”‚  LEARNED  â”‚   â”‚  MENTS    â”‚   â”‚           â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚               â”‚               â”‚               â”‚               â”‚
          â–¼               â–¼               â–¼               â–¼               â–¼
    â€¢ APT reports   â€¢ PCI-DSS      â€¢ Post-incident â€¢ Business       â€¢ MITRE ATT&CK
    â€¢ CVE alerts    â€¢ HIPAA          reviews        context        â€¢ Kill Chain
    â€¢ IOCs          â€¢ SOX         â€¢ Near misses   â€¢ Crown jewels   â€¢ Threat
    â€¢ ISAC feeds    â€¢ GDPR        â€¢ Tabletop      â€¢ Risk register    landscape
    â€¢ Dark web      â€¢ Industry      exercises     â€¢ Stakeholder    â€¢ Attack trees
      monitoring      regs                          input
                        </pre>
                    </div>
                </div>

                <h3>Stakeholder Communication</h3>
                
                <p>When gathering requirements from stakeholders, translate their language to SIEM terms:</p>
                
                <table>
                    <thead>
                        <tr>
                            <th>Stakeholder Says</th>
                            <th>They Mean</th>
                            <th>SIEM Translation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>"We need to know if someone's stealing our data"</td>
                            <td>Data exfiltration detection</td>
                            <td>Monitor: large outbound transfers, cloud uploads, USB copies, email attachments</td>
                        </tr>
                        <tr>
                            <td>"Alert us if hackers get in"</td>
                            <td>Initial access detection</td>
                            <td>Monitor: suspicious authentications, exploit attempts, phishing clicks</td>
                        </tr>
                        <tr>
                            <td>"Track privileged user activity"</td>
                            <td>Admin monitoring</td>
                            <td>Monitor: 4672 events, admin group changes, sensitive system access</td>
                        </tr>
                        <tr>
                            <td>"We're worried about ransomware"</td>
                            <td>Ransomware detection</td>
                            <td>Monitor: mass file modifications, shadow copy deletion, known ransomware patterns</td>
                        </tr>
                        <tr>
                            <td>"Auditors want login reports"</td>
                            <td>Compliance reporting</td>
                            <td>Dashboards: successful/failed logins, access to sensitive systems, admin activity</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Use Case Documentation Template</h3>
                
                <pre><code>USE CASE SPECIFICATION
======================

UC-ID: [Unique identifier, e.g., UC-AUTH-001]
Name: [Descriptive name]
Author: [Your name]
Date: [Creation date]
Version: [Version number]

1. BUSINESS CONTEXT
   - Business Problem: [What risk/requirement does this address?]
   - Stakeholder: [Who requested/owns this?]
   - Priority: [Critical/High/Medium/Low]
   - Compliance: [Related compliance requirements]

2. THREAT CONTEXT
   - MITRE ATT&CK: [Tactic/Technique IDs]
   - Kill Chain Phase: [Reconnaissance/Delivery/Exploitation/etc.]
   - Threat Actor: [If applicable - APT groups, insider, etc.]
   - Attack Scenario: [Brief description of attack this detects]

3. DATA REQUIREMENTS
   - Primary Log Source: [Firewall/Windows/Proxy/etc.]
   - Required Fields: [List specific fields needed]
   - Data Availability: [Confirmed/Needs onboarding]
   - Retention Requirement: [How long must data be kept?]

4. DETECTION LOGIC
   - Description: [Plain English detection description]
   - Threshold: [Specific values]
   - Time Window: [Detection timeframe]
   - Exclusions: [Known good patterns to exclude]

5. RESPONSE
   - Severity: [Critical/High/Medium/Low]
   - SLA: [Response time requirement]
   - Playbook: [Link to response playbook]
   - Escalation: [Escalation path]

6. TESTING & VALIDATION
   - Test Method: [How to validate detection works]
   - Expected FP Rate: [Acceptable false positive rate]
   - Review Cycle: [How often to review effectiveness]
</code></pre>

                <h2 id="data-mapping">Phase 2: Data Source Mapping</h2>
                
                <div class="workflow-diagram">
                    <div class="workflow-title">Mapping Use Cases to Data Sources</div>
                    <div class="workflow-container">
                        <pre class="diagram-ascii">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USE CASE â†’ DATA SOURCE MAPPING                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   USE CASE: Detect brute force attacks against user accounts                    â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ STEP 1: Identify what activity we're looking for                        â”‚   â”‚
â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚   â”‚ Activity: Multiple failed authentication attempts to same account       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ STEP 2: What systems can record this activity?                          â”‚   â”‚
â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚   â”‚ â€¢ Domain Controllers (Windows Security Log)                             â”‚   â”‚
â”‚   â”‚ â€¢ Azure AD (Sign-in Logs)                                               â”‚   â”‚
â”‚   â”‚ â€¢ VPN Concentrators                                                     â”‚   â”‚
â”‚   â”‚ â€¢ Web Applications (application logs)                                   â”‚   â”‚
â”‚   â”‚ â€¢ Linux servers (auth.log, sshd)                                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ STEP 3: What specific events/fields do we need?                         â”‚   â”‚
â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚  SOURCE              EVENT                 REQUIRED FIELDS              â”‚   â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚   â”‚  Windows DC          4625                  TargetUserName,              â”‚   â”‚
â”‚   â”‚                      (Failed Logon)        IpAddress, SubStatus,        â”‚   â”‚
â”‚   â”‚                                            LogonType                     â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚  Azure AD            SigninLogs            UserPrincipalName,           â”‚   â”‚
â”‚   â”‚                      ResultType=50126      IPAddress, ResultType,       â”‚   â”‚
â”‚   â”‚                                            AppDisplayName               â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚  Linux               auth.log              username, source_ip,         â”‚   â”‚
â”‚   â”‚                      "Failed password"     timestamp, service           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ STEP 4: Verify data is available in SIEM                                â”‚   â”‚
â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚   â”‚ â–¡ Data connector configured                                             â”‚   â”‚
â”‚   â”‚ â–¡ Events flowing to SIEM                                                â”‚   â”‚
â”‚   â”‚ â–¡ Required fields being parsed                                          â”‚   â”‚
â”‚   â”‚ â–¡ Data retention meets requirements                                     â”‚   â”‚
â”‚   â”‚ â–¡ Latency acceptable for detection SLA                                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </pre>
                    </div>
                </div>

                <h3>Data Source Reference Matrix</h3>
                
                <table>
                    <thead>
                        <tr>
                            <th>Detection Category</th>
                            <th>Primary Log Sources</th>
                            <th>Key Events/Tables</th>
                            <th>Critical Fields</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Authentication Attacks</strong></td>
                            <td>Windows DC, Azure AD, VPN</td>
                            <td>4624/4625, SigninLogs</td>
                            <td>User, IP, LogonType, Status</td>
                        </tr>
                        <tr>
                            <td><strong>Malware Execution</strong></td>
                            <td>EDR, Windows, Sysmon</td>
                            <td>4688, DeviceProcessEvents, Sysmon 1</td>
                            <td>Process, CommandLine, ParentProcess, Hash</td>
                        </tr>
                        <tr>
                            <td><strong>Lateral Movement</strong></td>
                            <td>Windows DC, Firewall, EDR</td>
                            <td>4624 (Type 3/10), 4648, SMB logs</td>
                            <td>SourceIP, DestIP, User, Service</td>
                        </tr>
                        <tr>
                            <td><strong>Data Exfiltration</strong></td>
                            <td>Proxy, DLP, Cloud Apps</td>
                            <td>Proxy logs, CloudAppEvents</td>
                            <td>User, Destination, BytesOut, FileName</td>
                        </tr>
                        <tr>
                            <td><strong>Persistence</strong></td>
                            <td>Sysmon, Windows, EDR</td>
                            <td>Sysmon 12/13, 4698, 7045</td>
                            <td>RegistryKey, TaskName, ServiceName</td>
                        </tr>
                        <tr>
                            <td><strong>Privilege Escalation</strong></td>
                            <td>Windows DC, EDR</td>
                            <td>4672, 4728, 4732</td>
                            <td>User, Group, PrivilegeList</td>
                        </tr>
                    </tbody>
                </table>

                <h2 id="design-logic">Phase 3: Design Detection Logic</h2>
                
                <div class="workflow-diagram">
                    <div class="workflow-title">Detection Logic Design Process</div>
                    <div class="workflow-container">
                        <pre class="diagram-ascii">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DETECTION LOGIC DESIGN                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ EXAMPLE: Password Spray Detection                                        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                  â”‚
â”‚   1. DEFINE THE PATTERN                                                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚   Attack Pattern: Attacker tries ONE password against MANY accounts             â”‚
â”‚   Distinguishing Feature: Same source IP, many unique users, failed logins      â”‚
â”‚                                                                                  â”‚
â”‚   2. DETERMINE THRESHOLDS                                                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚   â”‚  Parameter          â”‚  Threshold  â”‚  Rationale              â”‚               â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚   â”‚  Unique users       â”‚  >= 5       â”‚  Spray hits many users  â”‚               â”‚
â”‚   â”‚  Failed attempts    â”‚  >= 10      â”‚  Not just typos         â”‚               â”‚
â”‚   â”‚  Time window        â”‚  10 minutes â”‚  Attacks are fast       â”‚               â”‚
â”‚   â”‚  Source             â”‚  Single IP  â”‚  Same attacker source   â”‚               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                                  â”‚
â”‚   3. IDENTIFY EXCLUSIONS (Reduce False Positives)                               â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               â”‚
â”‚   â€¢ Exclude known load balancer/proxy IPs (many users behind one IP)            â”‚
â”‚   â€¢ Exclude monitoring/health check accounts                                     â”‚
â”‚   â€¢ Exclude known good IPs (office NAT ranges)                                  â”‚
â”‚   â€¢ Time-based: Exclude password reset windows                                   â”‚
â”‚                                                                                  â”‚
â”‚   4. DEFINE ALERT CONTEXT                                                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚   Include in alert:                                                              â”‚
â”‚   â€¢ Source IP + GeoIP                                                           â”‚
â”‚   â€¢ List of targeted usernames                                                  â”‚
â”‚   â€¢ Time of first/last attempt                                                  â”‚
â”‚   â€¢ Any successful logins from same IP                                          â”‚
â”‚   â€¢ Historical activity from this IP                                            â”‚
â”‚                                                                                  â”‚
â”‚   5. BUILD THE QUERY                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚                                                                                  â”‚
â”‚   SENTINEL KQL:                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ SigninLogs                                                               â”‚  â”‚
â”‚   â”‚ | where ResultType == "50126"  // Invalid username or password           â”‚  â”‚
â”‚   â”‚ | where IPAddress !in (known_proxy_ips)  // Exclusions                   â”‚  â”‚
â”‚   â”‚ | summarize                                                              â”‚  â”‚
â”‚   â”‚     TargetedUsers = dcount(UserPrincipalName),                           â”‚  â”‚
â”‚   â”‚     UserList = make_set(UserPrincipalName),                              â”‚  â”‚
â”‚   â”‚     AttemptCount = count(),                                              â”‚  â”‚
â”‚   â”‚     FirstAttempt = min(TimeGenerated),                                   â”‚  â”‚
â”‚   â”‚     LastAttempt = max(TimeGenerated)                                     â”‚  â”‚
â”‚   â”‚     by IPAddress, bin(TimeGenerated, 10m)                                â”‚  â”‚
â”‚   â”‚ | where TargetedUsers >= 5 and AttemptCount >= 10                        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                  â”‚
â”‚   SPLUNK SPL:                                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ index=windows EventCode=4625 SubStatus=0xC000006A                        â”‚  â”‚
â”‚   â”‚ | where NOT cidrmatch("10.0.0.0/8", Source_Network_Address)              â”‚  â”‚
â”‚   â”‚ | bin _time span=10m                                                     â”‚  â”‚
â”‚   â”‚ | stats dc(Account_Name) as TargetedUsers,                               â”‚  â”‚
â”‚   â”‚         values(Account_Name) as UserList,                                â”‚  â”‚
â”‚   â”‚         count as AttemptCount,                                           â”‚  â”‚
â”‚   â”‚         earliest(_time) as FirstAttempt,                                 â”‚  â”‚
â”‚   â”‚         latest(_time) as LastAttempt                                     â”‚  â”‚
â”‚   â”‚         by Source_Network_Address                                        â”‚  â”‚
â”‚   â”‚ | where TargetedUsers >= 5 AND AttemptCount >= 10                        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </pre>
                    </div>
                </div>

                <h2 id="mitre-mapping">MITRE ATT&CK & Kill Chain Mapping</h2>
                
                <div class="workflow-diagram">
                    <div class="workflow-title">Cyber Kill Chain vs MITRE ATT&CK</div>
                    <div class="workflow-container">
                        <pre class="diagram-ascii">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           CYBER KILL CHAIN              MITRE ATT&CK TACTICS                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚  â”‚ 1. RECONNAIS-   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  TA0043: Reconnaissance               â”‚
â”‚  â”‚    SANCE        â”‚                      â€¢ T1595: Active Scanning              â”‚
â”‚  â”‚ (Target researchâ”‚                      â€¢ T1592: Gather Victim Host Info      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚           â”‚                                                                      â”‚
â”‚           â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚  â”‚ 2. WEAPONIZ-    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  TA0042: Resource Development         â”‚
â”‚  â”‚    ATION        â”‚                      â€¢ T1587: Develop Capabilities         â”‚
â”‚  â”‚ (Create payload)â”‚                      â€¢ T1588: Obtain Capabilities          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚           â”‚                                                                      â”‚
â”‚           â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚  â”‚ 3. DELIVERY     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  TA0001: Initial Access               â”‚
â”‚  â”‚ (Send to target)â”‚                      â€¢ T1566: Phishing                     â”‚
â”‚  â”‚                 â”‚                      â€¢ T1190: Exploit Public App           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â€¢ T1078: Valid Accounts               â”‚
â”‚           â”‚                                                                      â”‚
â”‚           â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚  â”‚ 4. EXPLOITATION â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  TA0002: Execution                    â”‚
â”‚  â”‚ (Trigger vuln)  â”‚                      â€¢ T1059: Command/Script Interpreter   â”‚
â”‚  â”‚                 â”‚                      â€¢ T1204: User Execution               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚           â”‚                                                                      â”‚
â”‚           â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      TA0003: Persistence                   â”‚
â”‚  â”‚ 5. INSTALLATION â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â€¢ T1547: Boot/Logon Autostart        â”‚
â”‚  â”‚ (Establish      â”‚                      â€¢ T1053: Scheduled Task               â”‚
â”‚  â”‚  persistence)   â”‚                      â€¢ T1543: Create/Modify Service        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚           â”‚                               TA0004: Privilege Escalation          â”‚
â”‚           â”‚                               TA0005: Defense Evasion               â”‚
â”‚           â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      TA0006: Credential Access             â”‚
â”‚  â”‚ 6. COMMAND &    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â€¢ T1003: OS Credential Dumping       â”‚
â”‚  â”‚    CONTROL      â”‚                                                            â”‚
â”‚  â”‚ (Remote control)â”‚                      TA0011: Command and Control           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â€¢ T1071: Application Layer Protocol   â”‚
â”‚           â”‚                               â€¢ T1573: Encrypted Channel            â”‚
â”‚           â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      TA0007: Discovery                     â”‚
â”‚  â”‚ 7. ACTIONS ON   â”‚                      TA0008: Lateral Movement              â”‚
â”‚  â”‚    OBJECTIVES   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  TA0009: Collection                   â”‚
â”‚  â”‚ (Achieve goal)  â”‚                      TA0010: Exfiltration                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      TA0040: Impact                        â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 KEY INSIGHT: Kill Chain is LINEAR (7 steps), ATT&CK is a MATRIX (14 tactics).
 Attackers may loop back or skip phases. Use both frameworks together.
                        </pre>
                    </div>
                </div>

                <h3>Mapping Use Cases to Frameworks</h3>
                
                <table>
                    <thead>
                        <tr>
                            <th>Use Case</th>
                            <th>Kill Chain Phase</th>
                            <th>MITRE Tactic</th>
                            <th>MITRE Technique</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Brute force detection</td>
                            <td>Delivery</td>
                            <td>Initial Access (TA0001)</td>
                            <td>T1110 - Brute Force</td>
                        </tr>
                        <tr>
                            <td>Suspicious PowerShell</td>
                            <td>Exploitation</td>
                            <td>Execution (TA0002)</td>
                            <td>T1059.001 - PowerShell</td>
                        </tr>
                        <tr>
                            <td>New scheduled task</td>
                            <td>Installation</td>
                            <td>Persistence (TA0003)</td>
                            <td>T1053.005 - Scheduled Task</td>
                        </tr>
                        <tr>
                            <td>LSASS memory access</td>
                            <td>Installation</td>
                            <td>Credential Access (TA0006)</td>
                            <td>T1003.001 - LSASS Memory</td>
                        </tr>
                        <tr>
                            <td>DNS beaconing</td>
                            <td>C2</td>
                            <td>C2 (TA0011)</td>
                            <td>T1071.004 - DNS</td>
                        </tr>
                        <tr>
                            <td>Large data upload</td>
                            <td>Actions</td>
                            <td>Exfiltration (TA0010)</td>
                            <td>T1567 - Exfil to Cloud</td>
                        </tr>
                    </tbody>
                </table>

                <h2 id="implementation">Phase 4: Implementation</h2>
                
                <h3>Splunk Implementation Checklist</h3>
                
                <pre><code>SPLUNK CORRELATION SEARCH SETUP
===============================

1. Navigate: Settings â†’ Searches, reports, and alerts
2. Create New â†’ Scheduled Search

Configuration:
- Search: [Your SPL query]
- Schedule: Every 5-15 minutes (based on use case)
- Time Range: -15m to now (overlap to catch stragglers)
- Alert Actions:
  â–¡ Add to Triggered Alerts
  â–¡ Create Notable Event (for ES)
  â–¡ Send to SOAR
  
Notable Event Fields:
- Title: "Password Spray Detected from {src_ip}"
- Urgency: High
- Owner: Unassigned
- Status: New
- Drill-down search: Detailed investigation query
- Next Steps: Link to playbook

Throttling:
- Suppress for: 1 hour
- Fields to group by: src_ip (don't alert on same IP repeatedly)
</code></pre>

                <h3>Sentinel Implementation Checklist</h3>
                
                <pre><code>SENTINEL ANALYTICS RULE SETUP
=============================

1. Navigate: Microsoft Sentinel â†’ Analytics â†’ Create â†’ Scheduled query rule

General Tab:
- Name: "Password Spray Attack Detected"
- Description: [Detailed description]
- Severity: High
- MITRE ATT&CK: Initial Access - T1110.003
- Status: Enabled

Rule Logic Tab:
- Rule query: [Your KQL query]
- Entity mapping:
  â€¢ Account: UserPrincipalName
  â€¢ IP: IPAddress
- Query scheduling: Run every 5 minutes
- Lookup data from: Last 10 minutes
- Alert threshold: > 0 results

Incident Settings Tab:
- Create incidents: Enabled
- Alert grouping: Group related alerts into a single incident
- Grouping: By IPAddress (within 5 hours)

Automated Response Tab:
- Attach playbook: "Isolate-Compromised-Account"
</code></pre>

                <h2 id="testing-validation">Phase 5: Testing & Validation</h2>
                
                <div class="workflow-diagram">
                    <div class="workflow-title">Detection Testing Workflow</div>
                    <div class="workflow-container">
                        <pre class="diagram-ascii">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DETECTION TESTING WORKFLOW                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ 1. UNIT TESTING - Does the query work?                                 â”‚    â”‚
â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚
â”‚   â”‚ â€¢ Run query against historical data with known attacks                 â”‚    â”‚
â”‚   â”‚ â€¢ Verify query syntax is correct                                       â”‚    â”‚
â”‚   â”‚ â€¢ Check query performance (run time < 30 seconds)                      â”‚    â”‚
â”‚   â”‚ â€¢ Validate entity mapping extracts correct fields                      â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ 2. INTEGRATION TESTING - Does the alert fire?                          â”‚    â”‚
â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚
â”‚   â”‚ â€¢ Enable rule in test/dev environment                                  â”‚    â”‚
â”‚   â”‚ â€¢ Simulate attack using Atomic Red Team:                               â”‚    â”‚
â”‚   â”‚   > Invoke-AtomicTest T1110.003 -TestNumbers 1                         â”‚    â”‚
â”‚   â”‚ â€¢ Verify alert generated within expected time                          â”‚    â”‚
â”‚   â”‚ â€¢ Check alert contains all required context                            â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ 3. FALSE POSITIVE TESTING - Does it alert on normal activity?          â”‚    â”‚
â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚
â”‚   â”‚ â€¢ Run in "alert-only" mode for 1-2 weeks (don't page SOC yet)          â”‚    â”‚
â”‚   â”‚ â€¢ Review all generated alerts                                          â”‚    â”‚
â”‚   â”‚ â€¢ Categorize: True Positive / False Positive / Benign True Positive    â”‚    â”‚
â”‚   â”‚ â€¢ Tune thresholds and exclusions based on findings                     â”‚    â”‚
â”‚   â”‚ â€¢ Target: <20% false positive rate                                     â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ 4. PRODUCTION DEPLOYMENT - Go live                                      â”‚    â”‚
â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚
â”‚   â”‚ â€¢ Enable alert routing to SOC queue                                    â”‚    â”‚
â”‚   â”‚ â€¢ Train analysts on use case and response procedures                   â”‚    â”‚
â”‚   â”‚ â€¢ Document in detection catalog                                        â”‚    â”‚
â”‚   â”‚ â€¢ Set review date (30/60/90 days)                                      â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                       â”‚                                         â”‚
â”‚                                       â–¼                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ 5. CONTINUOUS VALIDATION - Keep it working                              â”‚    â”‚
â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚
â”‚   â”‚ â€¢ Periodic red team/purple team testing                                â”‚    â”‚
â”‚   â”‚ â€¢ Track detection metrics (TP, FP, FN rates)                           â”‚    â”‚
â”‚   â”‚ â€¢ Update for new attack variations                                     â”‚    â”‚
â”‚   â”‚ â€¢ Retire if threat no longer relevant                                  â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </pre>
                    </div>
                </div>

                <div class="info-box interview">
                    <div class="info-box-header">
                        <span class="info-box-icon">ğŸ’¼</span>
                        Interview Question
                    </div>
                    <div class="info-box-content">
                        <p><strong>"Walk me through how you would develop a new SIEM use case."</strong></p>
                        <ol>
                            <li><strong>Requirements:</strong> Start by understanding the threat or compliance requirement. Map to MITRE ATT&CK. Document the business context and stakeholder.</li>
                            <li><strong>Data Mapping:</strong> Identify which log sources capture this activity. Verify the data is being collected and has the required fields.</li>
                            <li><strong>Logic Design:</strong> Define the detection pattern, thresholds, time windows, and exclusions. Write the query in SPL/KQL.</li>
                            <li><strong>Implementation:</strong> Configure the scheduled search/analytics rule. Set up alerting, entity mapping, and incident creation.</li>
                            <li><strong>Testing:</strong> Validate with Atomic Red Team. Run in test mode to baseline false positives. Tune thresholds.</li>
                            <li><strong>Deployment:</strong> Enable in production. Train SOC. Document in detection catalog. Schedule periodic reviews.</li>
                        </ol>
                    </div>
                </div>

                <h2 id="summary">Chapter Summary</h2>
                
                <ul>
                    <li><strong>Requirements Sources:</strong> Threat intel, compliance, incidents, business needs, threat modeling</li>
                    <li><strong>Stakeholder Translation:</strong> Convert business language to SIEM terms (events, log sources, thresholds)</li>
                    <li><strong>Data Mapping:</strong> Activity â†’ Log Sources â†’ Events â†’ Fields â†’ Verify availability</li>
                    <li><strong>Detection Logic:</strong> Pattern + Thresholds + Exclusions + Context = Effective detection</li>
                    <li><strong>Framework Mapping:</strong> Use both Kill Chain (linear) and MITRE ATT&CK (matrix) for coverage</li>
                    <li><strong>Testing:</strong> Unit test â†’ Integration test â†’ FP testing â†’ Production â†’ Continuous validation</li>
                    <li><strong>Documentation:</strong> Every use case needs: business context, MITRE mapping, data requirements, detection logic, response playbook</li>
                </ul>
                
                <div class="page-navigation">
                    <a href="a-2-network-fundamentals.html" class="nav-button prev">
                        <span class="nav-button-icon">â†</span>
                        <div>
                            <span class="nav-button-label">Previous</span>
                            <span class="nav-button-title">Network Fundamentals</span>
                        </div>
                    </a>
                    <a href="index.html" class="nav-button next">
                        <span class="nav-button-icon">â†’</span>
                        <div>
                            <span class="nav-button-label">Back to</span>
                            <span class="nav-button-title">Home</span>
                        </div>
                    </a>
                </div>
            </div>
        </main>
    </div>
    
    <script src="main.js"></script>
</body>
</html>
