<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UEBA - Microsoft Sentinel Guide</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
            </svg>
            Sentinel Guide
        </a>
        <ul class="navbar-nav">
            <li><a href="index.html">Home</a></li>
            <li><a href="architecture.html">Architecture</a></li>
            <li><a href="analytics-rules.html">Analytics</a></li>
            <li><a href="automation.html">Automation</a></li>
        </ul>
        <button class="mobile-toggle" aria-label="Toggle menu">
            <svg viewBox="0 0 24 24" fill="none">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
        </button>
    </nav>

    <aside class="sidebar">
        <div class="sidebar-section">
            <div class="sidebar-title">Getting Started</div>
            <ul class="sidebar-nav">
                <li><a href="index.html">Home</a></li>
                <li><a href="architecture.html">Architecture</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Detection & Analytics</div>
            <ul class="sidebar-nav">
                <li><a href="analytics-rules.html">Analytics Rules</a></li>
                <li><a href="connector-rules.html">Connector Rules</a></li>
                <li><a href="correlation-rules.html">Correlation Rules</a></li>
                <li><a href="kql-library.html">KQL Library</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Investigation & Response</div>
            <ul class="sidebar-nav">
                <li><a href="incidents.html">Incidents</a></li>
                <li><a href="automation.html">Automation & SOAR</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Intelligence & Analytics</div>
            <ul class="sidebar-nav">
                <li><a href="workbooks.html">Workbooks</a></li>
                <li><a href="threat-intelligence.html">Threat Intelligence</a></li>
                <li><a href="ueba.html" class="active">UEBA</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Management</div>
            <ul class="sidebar-nav">
                <li><a href="content-hub.html">Content Hub</a></li>
                <li><a href="costs.html">Pricing & Costs</a></li>
                <li><a href="best-practices.html">Best Practices</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Quick Resources</div>
            <ul class="sidebar-nav">
                <li><a href="kql-cheatsheet.html">KQL Cheat Sheet</a></li>
                <li><a href="deployment-checklist.html">Deployment Checklist</a></li>
                <li><a href="interview-prep.html">Interview Prep</a></li>
            </ul>
        </div>
    </aside>

    <main class="main-content">
        <div class="content-container">
            <h1>User and Entity Behavior Analytics (UEBA)</h1>
            <p>Detect insider threats, compromised accounts, and advanced attacks using machine learning-based behavioral analysis that establishes baselines and identifies anomalies.</p>

            <div class="toc">
                <div class="toc-title">On This Page</div>
                <ul class="toc-list">
                    <li><a href="#overview">UEBA Overview</a></li>
                    <li><a href="#architecture">Architecture & Data Flow</a></li>
                    <li><a href="#enabling">Enabling UEBA</a></li>
                    <li><a href="#entity-types">Entity Types</a></li>
                    <li><a href="#anomaly-detection">Anomaly Detection</a></li>
                    <li><a href="#priority-scoring">Investigation Priority</a></li>
                    <li><a href="#entity-pages">Entity Pages</a></li>
                    <li><a href="#tables">UEBA Tables</a></li>
                    <li><a href="#queries">Investigation Queries</a></li>
                    <li><a href="#analytics-rules">UEBA Analytics Rules</a></li>
                    <li><a href="#use-cases">Use Cases</a></li>
                    <li><a href="#best-practices">Best Practices</a></li>
                </ul>
            </div>

            <h2 id="overview">UEBA Overview</h2>
            <p>UEBA uses machine learning to analyze user and entity behavior patterns, establish baselines, and detect anomalies that may indicate compromised accounts, insider threats, or advanced persistent threats.</p>

            <div class="card-grid">
                <div class="card">
                    <div class="card-title">ğŸ¯ Insider Threat Detection</div>
                    <div class="card-body">
                        <p>Identify malicious insiders or compromised accounts through behavioral deviations from established patterns.</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ¤– Machine Learning</div>
                    <div class="card-body">
                        <p>Automated baseline learning and anomaly detection without manual threshold configuration.</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ“Š Risk Scoring</div>
                    <div class="card-body">
                        <p>Investigation priority scores (0-10) help analysts focus on the highest-risk entities.</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ”— Entity Correlation</div>
                    <div class="card-body">
                        <p>Correlate activities across users, hosts, IPs, and applications for comprehensive visibility.</p>
                    </div>
                </div>
            </div>

            <h2 id="architecture">Architecture & Data Flow</h2>
            <p>UEBA processes data through multiple stages to identify behavioral anomalies.</p>

            <div class="ascii-diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            UEBA ARCHITECTURE                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   DATA SOURCES                                                                   â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚  Azure AD   â”‚  â”‚   M365      â”‚  â”‚  Windows    â”‚  â”‚   MDE       â”‚           â”‚
â”‚   â”‚ SigninLogs  â”‚  â”‚ Defender    â”‚  â”‚  Security   â”‚  â”‚  Device     â”‚           â”‚
â”‚   â”‚ AuditLogs   â”‚  â”‚  Alerts     â”‚  â”‚   Events    â”‚  â”‚  Events     â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚          â”‚                â”‚                â”‚                â”‚                   â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                    â”‚                                             â”‚
â”‚                                    â–¼                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        ENTITY RESOLUTION                                 â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   â€¢ Normalize identities across sources (UPN, SID, SAM, Email)          â”‚   â”‚
â”‚   â”‚   â€¢ Map devices to users                                                 â”‚   â”‚
â”‚   â”‚   â€¢ Resolve IP addresses to geographic locations                         â”‚   â”‚
â”‚   â”‚   â€¢ Build entity relationship graph                                      â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                             â”‚
â”‚                                    â–¼                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        BASELINE LEARNING                                 â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Per-Entity Baselines:              Peer Group Baselines:               â”‚   â”‚
â”‚   â”‚   â€¢ Login times                      â€¢ Department averages               â”‚   â”‚
â”‚   â”‚   â€¢ Locations                        â€¢ Role-based patterns               â”‚   â”‚
â”‚   â”‚   â€¢ Applications accessed            â€¢ Geographic norms                  â”‚   â”‚
â”‚   â”‚   â€¢ Data volumes                     â€¢ Activity frequency                â”‚   â”‚
â”‚   â”‚   â€¢ Network connections              â€¢ Resource access patterns          â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Learning Period: 14-21 days for initial baseline                       â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                             â”‚
â”‚                                    â–¼                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                        ANOMALY DETECTION                                 â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   ML Algorithms:                     Detection Types:                    â”‚   â”‚
â”‚   â”‚   â€¢ Statistical deviation            â€¢ First-time activities            â”‚   â”‚
â”‚   â”‚   â€¢ Peer group comparison            â€¢ Unusual patterns                  â”‚   â”‚
â”‚   â”‚   â€¢ Time-series analysis             â€¢ Volume anomalies                  â”‚   â”‚
â”‚   â”‚   â€¢ Clustering                       â€¢ Geographic impossibilities        â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                             â”‚
â”‚                                    â–¼                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                           OUTPUTS                                        â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€                                                                â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚
â”‚   â”‚   â”‚ BehaviorAnalyticsâ”‚  â”‚  Entity Pages  â”‚  â”‚  Investigation  â”‚         â”‚   â”‚
â”‚   â”‚   â”‚     Table        â”‚  â”‚  with Timeline â”‚  â”‚  Priority Score â”‚         â”‚   â”‚
â”‚   â”‚   â”‚                  â”‚  â”‚                â”‚  â”‚    (0-10)       â”‚         â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ Anomaly detailsâ”‚  â”‚ â€¢ User page    â”‚  â”‚                 â”‚         â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ Activity type  â”‚  â”‚ â€¢ Host page    â”‚  â”‚ â€¢ 0-3: Low      â”‚         â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ Insights       â”‚  â”‚ â€¢ IP page      â”‚  â”‚ â€¢ 4-6: Medium   â”‚         â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ Evidence       â”‚  â”‚ â€¢ Activity log â”‚  â”‚ â€¢ 7-10: High    â”‚         â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2 id="enabling">Enabling UEBA</h2>
            <p>UEBA must be enabled in Sentinel settings and requires specific data sources.</p>

            <h3>Prerequisites</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Requirement</th>
                            <th>Details</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Azure AD Logs</strong></td>
                            <td>SigninLogs and AuditLogs connected</td>
                            <td>Required</td>
                        </tr>
                        <tr>
                            <td><strong>Azure AD P1/P2</strong></td>
                            <td>Premium license for full sign-in data</td>
                            <td>Required</td>
                        </tr>
                        <tr>
                            <td><strong>Identity Sync</strong></td>
                            <td>IdentityInfo table populated</td>
                            <td>Required</td>
                        </tr>
                        <tr>
                            <td><strong>Windows Events</strong></td>
                            <td>Security events (4624, 4625, etc.)</td>
                            <td>Recommended</td>
                        </tr>
                        <tr>
                            <td><strong>M365 Defender</strong></td>
                            <td>DeviceEvents, DeviceLogonEvents</td>
                            <td>Recommended</td>
                        </tr>
                        <tr>
                            <td><strong>Learning Period</strong></td>
                            <td>14-21 days for baseline establishment</td>
                            <td>Required</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Enable UEBA Steps</h3>
            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">
                        Step 1: Navigate to Entity Behavior Settings
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <p><strong>Path:</strong> Microsoft Sentinel â†’ Settings â†’ Settings tab â†’ Entity behavior analytics</p>
                        <p>Click "Set UEBA" to open the configuration blade.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Step 2: Select Data Sources
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <p>Enable the following data sources for UEBA analysis:</p>
                        <ul>
                            <li><strong>Azure Active Directory:</strong> Sign-in and audit logs</li>
                            <li><strong>Azure Activity:</strong> Azure resource management</li>
                            <li><strong>Windows Security Events:</strong> On-premises authentication</li>
                            <li><strong>Security Alerts:</strong> Alerts from all connected products</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Step 3: Sync Identity Information
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <p>Enable Azure AD identity sync to populate the IdentityInfo table:</p>
                        <ul>
                            <li>Toggle "Sync Azure Active Directory users" to On</li>
                            <li>This populates user details: department, manager, job title, group memberships</li>
                            <li>Enables peer group analysis for anomaly detection</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Step 4: Configure Anomaly Rules
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <p>Navigate to Analytics â†’ Rule templates â†’ Filter by "ML Behavior Analytics"</p>
                        <p>Enable built-in anomaly detection rules:</p>
                        <ul>
                            <li>Anomalous Azure AD sign-in activity</li>
                            <li>Anomalous user resource access</li>
                            <li>Anomalous data sharing activity</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="alert alert-warning">
                <svg class="alert-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
                <div class="alert-content">
                    <div class="alert-title">Baseline Learning Period</div>
                    <p class="alert-text">UEBA requires 14-21 days to establish behavioral baselines. During this period, anomalies may not be accurate. Wait for baseline completion before relying on UEBA alerts for investigations.</p>
                </div>
            </div>

            <h2 id="entity-types">Entity Types</h2>
            <p>UEBA tracks behavior patterns for multiple entity types.</p>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Entity Type</th>
                            <th>Identifiers</th>
                            <th>Baseline Attributes</th>
                            <th>Anomaly Examples</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>User Account</strong></td>
                            <td>UPN, SID, AadUserId, SAMAccountName, Email</td>
                            <td>Login times, locations, apps, devices, data access patterns, peer group</td>
                            <td>Login from new country, unusual hour access, first-time app usage, mass file download</td>
                        </tr>
                        <tr>
                            <td><strong>Host/Device</strong></td>
                            <td>Hostname, FQDN, AzureID, MDE DeviceId</td>
                            <td>Running processes, network connections, logged-on users, installed software</td>
                            <td>New process execution, unusual outbound connection, first-time admin logon</td>
                        </tr>
                        <tr>
                            <td><strong>IP Address</strong></td>
                            <td>IPv4, IPv6</td>
                            <td>Geographic location, ASN, reputation, connection frequency</td>
                            <td>Connection from blacklisted IP, impossible travel, new source country</td>
                        </tr>
                        <tr>
                            <td><strong>Cloud Resource</strong></td>
                            <td>ResourceId, SubscriptionId</td>
                            <td>Access patterns, API calls, configuration changes</td>
                            <td>Mass deletion, unusual API calls, configuration drift</td>
                        </tr>
                        <tr>
                            <td><strong>Azure AD Application</strong></td>
                            <td>AppId, ServicePrincipalId</td>
                            <td>OAuth consent patterns, API usage, user assignments</td>
                            <td>New app consent, unusual permission request, mass user assignment</td>
                        </tr>
                        <tr>
                            <td><strong>Mailbox</strong></td>
                            <td>MailboxPrimaryAddress, ExchangeGuid</td>
                            <td>Email patterns, forwarding rules, login locations</td>
                            <td>New forwarding rule, mass email deletion, unusual send volume</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2 id="anomaly-detection">Anomaly Detection Categories</h2>
            <p>UEBA detects various anomaly categories using machine learning algorithms.</p>

            <div class="ascii-diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ANOMALY DETECTION CATEGORIES                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   FIRST-TIME ACTIVITIES                    UNUSUAL PATTERNS                      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚   â€¢ FirstTimeUserConnectedViaCountry       â€¢ UnusualVolumeOfDataMovement         â”‚
â”‚   â€¢ FirstTimeUserAccessedApplication       â€¢ AnomalousLoginTime                  â”‚
â”‚   â€¢ FirstTimeUserUsedDevice                â€¢ UnusualResourceAccess               â”‚
â”‚   â€¢ FirstTimeUserPerformedAction           â€¢ AnomalousBrowsingActivity           â”‚
â”‚   â€¢ FirstTimeUserLoggedOnToHost            â€¢ UnusualNumberOfFailedLogins         â”‚
â”‚   â€¢ FirstTimeUserUsedIPAddress             â€¢ AnomalousDownloadActivity           â”‚
â”‚                                                                                  â”‚
â”‚   GEOGRAPHIC ANOMALIES                     VOLUME ANOMALIES                      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚   â€¢ ImpossibleTravel                       â€¢ MassiveDataDownload                 â”‚
â”‚   â€¢ AnomalousGeolocation                   â€¢ UnusualMailboxActivity              â”‚
â”‚   â€¢ ConnectionFromRareCountry              â€¢ AnomalousEmailSendVolume            â”‚
â”‚   â€¢ SigninFromUnfamiliarLocation           â€¢ MassFileDeletion                    â”‚
â”‚   â€¢ VPNFromUnusualLocation                 â€¢ BulkSharePointAccess                â”‚
â”‚                                                                                  â”‚
â”‚   PRIVILEGE ANOMALIES                      AUTHENTICATION ANOMALIES              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚
â”‚   â€¢ UnusualPrivilegedRoleAssignment        â€¢ BruteForceAttempt                   â”‚
â”‚   â€¢ AnomalousAdminActivity                 â€¢ PasswordSpray                       â”‚
â”‚   â€¢ FirstTimeAdminAction                   â€¢ TokenTheft                          â”‚
â”‚   â€¢ ElevatedAccessAnomaly                  â€¢ SessionHijacking                    â”‚
â”‚   â€¢ RarePrivilegedOperation                â€¢ MFABypass                           â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h3>Anomaly Details</h3>
            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">
                        Impossible Travel
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <p><strong>Description:</strong> User authenticates from two geographically distant locations in a timeframe that would be physically impossible to travel.</p>
                        <p><strong>Example:</strong> Login from New York at 10:00 AM, then login from Tokyo at 10:30 AM</p>
                        <p><strong>Investigation:</strong> Check if VPN usage, shared accounts, or compromised credentials. Verify with user.</p>
                        <p><strong>False Positive Causes:</strong> VPN exit nodes, mobile device roaming, cloud app proxies</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        First-Time Country Connection
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <p><strong>Description:</strong> User connects from a country they have never connected from before.</p>
                        <p><strong>Example:</strong> US-based employee suddenly logging in from Russia</p>
                        <p><strong>Investigation:</strong> Verify travel plans, check for credential compromise, review session activity</p>
                        <p><strong>False Positive Causes:</strong> Legitimate business travel, VPN usage</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Anomalous Data Movement
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <p><strong>Description:</strong> User downloads, uploads, or shares significantly more data than their normal pattern.</p>
                        <p><strong>Example:</strong> User typically downloads 100MB/day but suddenly downloads 10GB</p>
                        <p><strong>Investigation:</strong> Check what data was accessed, verify legitimate business need, check for exfiltration</p>
                        <p><strong>False Positive Causes:</strong> Project deadlines, onboarding new team members, legitimate data migration</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Unusual Application Access
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <p><strong>Description:</strong> User accesses an application they have never used before, especially sensitive apps.</p>
                        <p><strong>Example:</strong> Marketing user accessing HR payroll system for the first time</p>
                        <p><strong>Investigation:</strong> Verify role change, check for lateral movement, review actions taken in app</p>
                        <p><strong>False Positive Causes:</strong> New job responsibilities, cross-department collaboration</p>
                    </div>
                </div>
            </div>

            <h2 id="priority-scoring">Investigation Priority Scoring</h2>
            <p>UEBA assigns an Investigation Priority score (0-10) to each entity based on anomaly severity and frequency.</p>

            <div class="ascii-diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     INVESTIGATION PRIORITY SCORING                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   SCORE CALCULATION                                                              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                              â”‚
â”‚                                                                                  â”‚
â”‚   Priority = f(Anomaly Severity Ã— Anomaly Frequency Ã— Entity Criticality)       â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   LOW (0-3)          MEDIUM (4-6)         HIGH (7-10)                   â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   â€¢ Minor            â€¢ Multiple            â€¢ Critical                    â”‚   â”‚
â”‚   â”‚     deviations         anomalies            anomalies                   â”‚   â”‚
â”‚   â”‚   â€¢ First-time       â€¢ Unusual             â€¢ Impossible                 â”‚   â”‚
â”‚   â”‚     activities         patterns              travel                      â”‚   â”‚
â”‚   â”‚   â€¢ Normal for       â€¢ Needs               â€¢ Admin account              â”‚   â”‚
â”‚   â”‚     peer group         investigation         compromise                 â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Action:            Action:               Action:                       â”‚   â”‚
â”‚   â”‚   Monitor            Investigate           Immediate                     â”‚   â”‚
â”‚   â”‚                      within 24h            Response                      â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚   FACTORS THAT INCREASE SCORE:                                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                 â”‚
â”‚   â€¢ Multiple anomalies in short timeframe                                       â”‚
â”‚   â€¢ Privileged account involved                                                 â”‚
â”‚   â€¢ Sensitive resource accessed                                                 â”‚
â”‚   â€¢ Correlation with security alerts                                            â”‚
â”‚   â€¢ Deviation from peer group average                                           â”‚
â”‚   â€¢ Known threat intelligence match                                             â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2 id="entity-pages">Entity Pages</h2>
            <p>Entity pages provide comprehensive views of user, host, and IP behavior.</p>

            <h3>User Entity Page</h3>
            <div class="ascii-diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           USER ENTITY PAGE                                       â”‚
â”‚                       user@company.com                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   IDENTITY INFORMATION                     INVESTIGATION PRIORITY               â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚   Name: John Smith                         Score: 7.2 / 10  [HIGH]              â”‚
â”‚   UPN: john.smith@company.com                                                    â”‚
â”‚   Department: Engineering                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚   Title: Senior Developer                  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚             â”‚
â”‚   Manager: jane.doe@company.com            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚   Location: Seattle, WA                                                          â”‚
â”‚   Groups: Engineering, VPN-Users           Recent Anomalies: 3                  â”‚
â”‚                                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   RECENT ANOMALIES                                                               â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                               â”‚
â”‚                                                                                  â”‚
â”‚   âš ï¸  2024-01-15 09:23  ImpossibleTravel         New York â†’ London (2hr)        â”‚
â”‚   âš ï¸  2024-01-15 10:45  FirstTimeAppAccess       HR Payroll System              â”‚
â”‚   âš ï¸  2024-01-14 23:15  AnomalousLoginTime       Login at 11:15 PM (unusual)    â”‚
â”‚                                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ACTIVITY TIMELINE (Last 7 days)                                               â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚
â”‚                                                                                  â”‚
â”‚   Jan 15  â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—  12 sign-ins, 3 anomalies                 â”‚
â”‚   Jan 14  â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—            8 sign-ins, 1 anomaly                     â”‚
â”‚   Jan 13  â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—       10 sign-ins, 0 anomalies                  â”‚
â”‚   Jan 12  â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—                 6 sign-ins, 0 anomalies                   â”‚
â”‚   ...                                                                            â”‚
â”‚                                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   RELATED INCIDENTS                        PEER COMPARISON                       â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚
â”‚                                                                                  â”‚
â”‚   ğŸ”´ INC-2024-0123  High Sev              Avg sign-ins:  You: 45  Peers: 32    â”‚
â”‚   ğŸŸ¡ INC-2024-0098  Medium Sev            Locations:     You: 4   Peers: 1.5   â”‚
â”‚   ğŸŸ¢ INC-2024-0045  Low Sev               Apps accessed: You: 12  Peers: 8     â”‚
â”‚                                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   INSIGHTS                                                                       â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€                                                                       â”‚
â”‚                                                                                  â”‚
â”‚   â€¢ User has accessed 3 new applications this week (unusual)                    â”‚
â”‚   â€¢ Login times shifted 4 hours later than normal pattern                       â”‚
â”‚   â€¢ Data download volume 5x higher than peer group average                      â”‚
â”‚   â€¢ First time accessing resources from UK IP range                             â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h3>Host Entity Page</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Section</th>
                            <th>Information</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Device Info</strong></td>
                            <td>Hostname, OS, Azure ID, MDE status, last seen</td>
                            <td>Asset identification</td>
                        </tr>
                        <tr>
                            <td><strong>Risk Score</strong></td>
                            <td>Investigation priority, MDE risk level, exposure score</td>
                            <td>Prioritization</td>
                        </tr>
                        <tr>
                            <td><strong>Logged-on Users</strong></td>
                            <td>Interactive and service accounts currently logged on</td>
                            <td>User correlation</td>
                        </tr>
                        <tr>
                            <td><strong>Active Alerts</strong></td>
                            <td>Security alerts associated with this host</td>
                            <td>Threat context</td>
                        </tr>
                        <tr>
                            <td><strong>Network Connections</strong></td>
                            <td>Inbound/outbound connections, protocols, ports</td>
                            <td>C2 detection</td>
                        </tr>
                        <tr>
                            <td><strong>Process Activity</strong></td>
                            <td>Running processes, parent-child relationships</td>
                            <td>Malware investigation</td>
                        </tr>
                        <tr>
                            <td><strong>Anomalies</strong></td>
                            <td>First-time processes, unusual connections, behavior changes</td>
                            <td>Threat hunting</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2 id="tables">UEBA Tables</h2>
            <p>UEBA data is stored in several Log Analytics tables.</p>

            <h3>BehaviorAnalytics Table</h3>
            <p>Primary table containing all detected anomalies.</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - BehaviorAnalytics Schema</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>BehaviorAnalytics
| getschema
| project ColumnName, DataType, ColumnType

// Key columns:
// TimeGenerated          - When anomaly was detected
// UserPrincipalName      - User identity (for user anomalies)
// SourceDevice           - Host name (for device anomalies)
// SourceIPAddress        - IP address
// ActivityType           - Type of activity (SignIn, FileAccess, etc.)
// ActionType             - Specific action (Login, Download, etc.)
// ActivityInsights       - JSON with anomaly details
// UsersInsights          - JSON with user context
// DevicesInsights        - JSON with device context
// InvestigationPriority  - Score 0-10
// SourceRecordId         - Link to original event</pre>
                </div>
            </div>

            <h3>IdentityInfo Table</h3>
            <p>Contains synchronized user identity information from Azure AD.</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - IdentityInfo Query</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>IdentityInfo
| where TimeGenerated > ago(1d)
| project 
    AccountUPN,
    AccountDisplayName,
    Department,
    JobTitle,
    Manager,
    City,
    Country,
    GroupMembership,
    AssignedRoles,
    IsAccountEnabled,
    RiskLevel,
    RiskState
| take 100</pre>
                </div>
            </div>

            <h2 id="queries">Investigation Queries</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - All Anomalies for Specific User</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>let targetUser = "john.smith@company.com";
BehaviorAnalytics
| where TimeGenerated > ago(30d)
| where UserPrincipalName =~ targetUser
| project 
    TimeGenerated,
    ActivityType,
    ActionType,
    InvestigationPriority,
    ActivityInsights = parse_json(ActivityInsights),
    UsersInsights = parse_json(UsersInsights)
| extend 
    AnomalyTypes = ActivityInsights.AnomalyTypes,
    FirstTimeUser = ActivityInsights.FirstTimeUser,
    IsUnusual = ActivityInsights.IsUnusual
| sort by TimeGenerated desc</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - High Priority Users</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>BehaviorAnalytics
| where TimeGenerated > ago(7d)
| where InvestigationPriority > 7
| summarize 
    AnomalyCount = count(),
    MaxPriority = max(InvestigationPriority),
    AnomalyTypes = make_set(ActivityType),
    FirstSeen = min(TimeGenerated),
    LastSeen = max(TimeGenerated)
    by UserPrincipalName
| sort by MaxPriority desc, AnomalyCount desc
| project 
    UserPrincipalName,
    MaxPriority,
    AnomalyCount,
    AnomalyTypes,
    ActiveDays = datetime_diff('day', LastSeen, FirstSeen) + 1</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Impossible Travel Detection</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>BehaviorAnalytics
| where TimeGenerated > ago(7d)
| where ActivityInsights has "ImpossibleTravel"
| extend Insights = parse_json(ActivityInsights)
| project 
    TimeGenerated,
    UserPrincipalName,
    SourceIPAddress,
    Location1 = Insights.PreviousIPGeolocation,
    Location2 = Insights.CurrentIPGeolocation,
    TimeBetween = Insights.TimeBetweenActivities,
    InvestigationPriority
| sort by InvestigationPriority desc</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - First-Time Activities</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>BehaviorAnalytics
| where TimeGenerated > ago(24h)
| where ActivityInsights has "FirstTimeUser"
| extend Insights = parse_json(ActivityInsights)
| extend FirstTimeType = Insights.FirstTimeUserTypes
| mv-expand FirstTimeType
| summarize 
    Count = count(),
    Users = make_set(UserPrincipalName, 10)
    by tostring(FirstTimeType)
| sort by Count desc

// Common first-time types:
// FirstTimeUserConnectedViaCountry
// FirstTimeUserAccessedApplication
// FirstTimeUserLoggedOnToDevice
// FirstTimeUserPerformedActivity
// FirstTimeUserUsedISP</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - User Risk Enrichment</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Combine UEBA with Azure AD Identity Protection
let UEBAUsers = BehaviorAnalytics
    | where TimeGenerated > ago(7d)
    | summarize 
        UEBAScore = max(InvestigationPriority),
        UEBAAnomalies = count()
        by UserPrincipalName;
let IdentityRisk = IdentityInfo
    | where TimeGenerated > ago(1d)
    | summarize arg_max(TimeGenerated, *) by AccountUPN
    | project UserPrincipalName = AccountUPN, AADRiskLevel = RiskLevel, RiskState;
let SigninRisk = SigninLogs
    | where TimeGenerated > ago(7d)
    | summarize 
        FailedLogins = countif(ResultType != "0"),
        RiskySignins = countif(RiskLevelDuringSignIn in ("high", "medium")),
        UniqueLocations = dcount(Location)
        by UserPrincipalName;
UEBAUsers
| join kind=leftouter IdentityRisk on UserPrincipalName
| join kind=leftouter SigninRisk on UserPrincipalName
| extend OverallRisk = case(
    UEBAScore > 7 or AADRiskLevel == "high", "Critical",
    UEBAScore > 5 or AADRiskLevel == "medium", "High",
    UEBAScore > 3, "Medium",
    "Low"
)
| sort by UEBAScore desc</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Anomalous Data Movement</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>BehaviorAnalytics
| where TimeGenerated > ago(7d)
| where ActivityType in ("FileDownloaded", "FileShared", "FileCopied", "FileUploaded")
| where InvestigationPriority > 5
| extend Insights = parse_json(ActivityInsights)
| project 
    TimeGenerated,
    UserPrincipalName,
    ActivityType,
    ActionType,
    VolumeAnomaly = Insights.UnusualVolumeIndicator,
    DataSizeGB = Insights.DataSizeInMB / 1024,
    PeerAverageGB = Insights.PeerGroupAverageInMB / 1024,
    InvestigationPriority
| where DataSizeGB > PeerAverageGB * 3  // 3x peer average
| sort by DataSizeGB desc</pre>
                </div>
            </div>

            <h2 id="analytics-rules">UEBA Analytics Rules</h2>
            <p>Create analytics rules that leverage UEBA data for automated alerting.</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - High Priority UEBA Alert Rule</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Scheduled rule: Run every 1 hour, look back 1 hour
BehaviorAnalytics
| where TimeGenerated > ago(1h)
| where InvestigationPriority >= 8
| extend Insights = parse_json(ActivityInsights)
| project 
    TimeGenerated,
    UserPrincipalName,
    SourceIPAddress,
    SourceDevice,
    ActivityType,
    ActionType,
    InvestigationPriority,
    AnomalyTypes = tostring(Insights.AnomalyTypes)
| extend 
    AccountCustomEntity = UserPrincipalName,
    IPCustomEntity = SourceIPAddress,
    HostCustomEntity = SourceDevice</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Multiple Anomalies Correlation Rule</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Alert when user has 3+ anomalies in 24 hours
BehaviorAnalytics
| where TimeGenerated > ago(24h)
| where InvestigationPriority > 5
| summarize 
    AnomalyCount = count(),
    AnomalyTypes = make_set(ActivityType),
    MaxPriority = max(InvestigationPriority),
    IPs = make_set(SourceIPAddress),
    Devices = make_set(SourceDevice)
    by UserPrincipalName
| where AnomalyCount >= 3
| extend 
    AccountCustomEntity = UserPrincipalName,
    AlertSeverity = case(
        MaxPriority >= 8, "High",
        MaxPriority >= 6, "Medium",
        "Low"
    )</pre>
                </div>
            </div>

            <h2 id="use-cases">Use Cases</h2>

            <div class="card-grid">
                <div class="card">
                    <div class="card-title">ğŸ” Compromised Account Detection</div>
                    <div class="card-body">
                        <p><strong>Scenario:</strong> Attacker steals credentials and uses them from different location.</p>
                        <p><strong>UEBA Signals:</strong></p>
                        <ul>
                            <li>Impossible travel detected</li>
                            <li>First-time country connection</li>
                            <li>Unusual login time</li>
                            <li>New device/browser</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ‘¤ Insider Threat</div>
                    <div class="card-body">
                        <p><strong>Scenario:</strong> Disgruntled employee preparing to exfiltrate data before leaving.</p>
                        <p><strong>UEBA Signals:</strong></p>
                        <ul>
                            <li>Mass file downloads</li>
                            <li>Unusual data sharing</li>
                            <li>Access to sensitive systems</li>
                            <li>After-hours activity</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ­ Privilege Escalation</div>
                    <div class="card-body">
                        <p><strong>Scenario:</strong> Attacker escalates privileges after initial compromise.</p>
                        <p><strong>UEBA Signals:</strong></p>
                        <ul>
                            <li>First-time admin action</li>
                            <li>Unusual role assignment</li>
                            <li>Accessing privileged resources</li>
                            <li>Service account anomalies</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ’» Lateral Movement</div>
                    <div class="card-body">
                        <p><strong>Scenario:</strong> Attacker moves between systems to reach target.</p>
                        <p><strong>UEBA Signals:</strong></p>
                        <ul>
                            <li>First-time host logon</li>
                            <li>Unusual network connections</li>
                            <li>Multiple failed authentications</li>
                            <li>Service account misuse</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h2 id="best-practices">Best Practices</h2>

            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">
                        Data Source Configuration
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Enable all recommended sources:</strong> Azure AD, Windows Security Events, M365 Defender for comprehensive visibility</li>
                            <li><strong>Sync IdentityInfo:</strong> Required for peer group analysis and user context</li>
                            <li><strong>Include HR data:</strong> Optional but improves baseline accuracy with department/role info</li>
                            <li><strong>Monitor data quality:</strong> Ensure consistent log ingestion for accurate baselines</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Baseline Management
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Wait for learning period:</strong> 14-21 days before trusting anomaly detection</li>
                            <li><strong>Account for seasonality:</strong> Business patterns change (holidays, quarter-end)</li>
                            <li><strong>Handle organizational changes:</strong> Mergers, reorgs may require baseline reset</li>
                            <li><strong>Exclude test accounts:</strong> Service accounts may skew baselines</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Alert Tuning
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Start with high-priority only:</strong> Begin with score â‰¥8 alerts</li>
                            <li><strong>Build watchlists:</strong> Known VPN IPs, travel-heavy users, service accounts</li>
                            <li><strong>Correlate with other signals:</strong> Combine UEBA with threat intel, security alerts</li>
                            <li><strong>Track false positive patterns:</strong> Document and exclude recurring FPs</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Investigation Workflow
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Use Entity Pages:</strong> Start investigation from user/host entity page for context</li>
                            <li><strong>Check peer comparison:</strong> Is behavior unusual for this user or their peer group?</li>
                            <li><strong>Correlate timeline:</strong> What else happened before/after the anomaly?</li>
                            <li><strong>Verify with user:</strong> For legitimate travel, new projects, role changes</li>
                            <li><strong>Document findings:</strong> Update incident with investigation notes</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="alert alert-info">
                <svg class="alert-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/>
                </svg>
                <div class="alert-content">
                    <div class="alert-title">Pro Tips</div>
                    <p class="alert-text">Use the Entity Behavior workbook from Content Hub for UEBA visualization. Combine UEBA with Identity Protection risk signals for comprehensive user risk scoring. Focus on correlation: a single anomaly is often benign, but multiple anomalies from the same user warrant investigation.</p>
                </div>
            </div>

            <footer class="footer">
                <div class="footer-content">
                    <svg class="footer-icon" viewBox="0 0 24 24">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                    Microsoft Sentinel Ultimate Guide
                </div>
            </footer>
        </div>
    </main>
    <script src="main.js"></script>
</body>
</html>
