<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Best Practices - Microsoft Sentinel Guide</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
            </svg>
            Sentinel Guide
        </a>
        <ul class="navbar-nav">
            <li><a href="index.html">Home</a></li>
            <li><a href="architecture.html">Architecture</a></li>
            <li><a href="analytics-rules.html">Analytics</a></li>
            <li><a href="automation.html">Automation</a></li>
        </ul>
        <button class="mobile-toggle" aria-label="Toggle menu">
            <svg viewBox="0 0 24 24" fill="none">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
        </button>
    </nav>

    <aside class="sidebar">
        <div class="sidebar-section">
            <div class="sidebar-title">Getting Started</div>
            <ul class="sidebar-nav">
                <li><a href="index.html">Home</a></li>
                <li><a href="architecture.html">Architecture</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Detection & Analytics</div>
            <ul class="sidebar-nav">
                <li><a href="analytics-rules.html">Analytics Rules</a></li>
                <li><a href="connector-rules.html">Connector Rules</a></li>
                <li><a href="correlation-rules.html">Correlation Rules</a></li>
                <li><a href="kql-library.html">KQL Library</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Investigation & Response</div>
            <ul class="sidebar-nav">
                <li><a href="incidents.html">Incidents</a></li>
                <li><a href="automation.html">Automation & SOAR</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Intelligence & Analytics</div>
            <ul class="sidebar-nav">
                <li><a href="workbooks.html">Workbooks</a></li>
                <li><a href="threat-intelligence.html">Threat Intelligence</a></li>
                <li><a href="ueba.html">UEBA</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Management</div>
            <ul class="sidebar-nav">
                <li><a href="content-hub.html">Content Hub</a></li>
                <li><a href="costs.html">Pricing & Costs</a></li>
                <li><a href="best-practices.html" class="active">Best Practices</a></li>
            </ul>
        </div>
    </aside>

    <main class="main-content">
        <div class="content-container">
            <h1>Best Practices</h1>
            <p>Enterprise deployment guidelines, SOC operational standards, and maturity model for Microsoft Sentinel implementations.</p>

            <div class="toc">
                <div class="toc-title">On This Page</div>
                <ul class="toc-list">
                    <li><a href="#deployment">Deployment Best Practices</a></li>
                    <li><a href="#detection">Detection Engineering</a></li>
                    <li><a href="#operations">SOC Operations</a></li>
                    <li><a href="#maturity">Maturity Model</a></li>
                    <li><a href="#metrics">Key Metrics</a></li>
                </ul>
            </div>

            <h2 id="deployment">Deployment Best Practices</h2>

            <div class="ascii-diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SENTINEL DEPLOYMENT CHECKLIST                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   PHASE 1: PLANNING                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚   â–¡ Define use cases and success criteria                                       â”‚
â”‚   â–¡ Inventory existing security tools and data sources                          â”‚
â”‚   â–¡ Estimate data volume and calculate costs                                    â”‚
â”‚   â–¡ Design workspace architecture (single vs multi-workspace)                   â”‚
â”‚   â–¡ Plan RBAC model and access controls                                         â”‚
â”‚   â–¡ Document retention requirements (compliance)                                â”‚
â”‚                                                                                  â”‚
â”‚   PHASE 2: FOUNDATION                                                           â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚   â–¡ Deploy Log Analytics workspace in appropriate region                        â”‚
â”‚   â–¡ Enable Microsoft Sentinel on workspace                                      â”‚
â”‚   â–¡ Configure Defender for Cloud integration                                    â”‚
â”‚   â–¡ Set up Azure AD diagnostic settings                                         â”‚
â”‚   â–¡ Deploy Data Collection Rules (DCRs)                                         â”‚
â”‚   â–¡ Configure commitment tier based on estimates                                â”‚
â”‚                                                                                  â”‚
â”‚   PHASE 3: DATA ONBOARDING                                                      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚   â–¡ Enable free data sources first (Azure AD, M365, Activity)                  â”‚
â”‚   â–¡ Deploy AMA agents to Windows/Linux servers                                  â”‚
â”‚   â–¡ Configure firewall/proxy CEF forwarding                                     â”‚
â”‚   â–¡ Connect cloud applications (AWS, GCP if applicable)                         â”‚
â”‚   â–¡ Validate data ingestion for each source                                     â”‚
â”‚   â–¡ Monitor for ingestion gaps or anomalies                                     â”‚
â”‚                                                                                  â”‚
â”‚   PHASE 4: DETECTION                                                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚   â–¡ Install relevant Content Hub solutions                                      â”‚
â”‚   â–¡ Enable analytics rules in staged approach                                   â”‚
â”‚   â–¡ Configure automation rules for triage                                       â”‚
â”‚   â–¡ Deploy enrichment playbooks                                                 â”‚
â”‚   â–¡ Tune rules based on initial false positives                                 â”‚
â”‚   â–¡ Map detection coverage to MITRE ATT&CK                                      â”‚
â”‚                                                                                  â”‚
â”‚   PHASE 5: OPERATIONS                                                           â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚   â–¡ Train SOC analysts on Sentinel UI                                           â”‚
â”‚   â–¡ Document incident response procedures                                       â”‚
â”‚   â–¡ Configure workbooks for monitoring                                          â”‚
â”‚   â–¡ Set up cost alerts and monitoring                                           â”‚
â”‚   â–¡ Establish rule review cadence                                               â”‚
â”‚   â–¡ Implement CI/CD for content management                                      â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h3>Workspace Architecture</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Scenario</th>
                            <th>Recommended Architecture</th>
                            <th>Rationale</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Single tenant, &lt;50K employees</strong></td>
                            <td>Single workspace</td>
                            <td>Simplicity, unified view</td>
                        </tr>
                        <tr>
                            <td><strong>Multi-region compliance</strong></td>
                            <td>Regional workspaces + Azure Lighthouse</td>
                            <td>Data residency requirements</td>
                        </tr>
                        <tr>
                            <td><strong>MSSP/Multi-tenant</strong></td>
                            <td>Customer workspaces + central management</td>
                            <td>Data isolation, per-customer billing</td>
                        </tr>
                        <tr>
                            <td><strong>Dev/Test separation</strong></td>
                            <td>Separate workspaces</td>
                            <td>Cost tracking, reduced noise</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2 id="detection">Detection Engineering</h2>

            <div class="card-grid">
                <div class="card">
                    <div class="card-title">ğŸ“ Rule Development</div>
                    <div class="card-body">
                        <ul>
                            <li>Start with Microsoft templates</li>
                            <li>Customize thresholds for environment</li>
                            <li>Add exclusion watchlists</li>
                            <li>Test in non-production first</li>
                            <li>Document false positive patterns</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ¯ Coverage Mapping</div>
                    <div class="card-body">
                        <ul>
                            <li>Map rules to MITRE ATT&CK</li>
                            <li>Identify coverage gaps</li>
                            <li>Prioritize by threat relevance</li>
                            <li>Balance detection vs noise</li>
                            <li>Review quarterly</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ”§ Tuning Process</div>
                    <div class="card-body">
                        <ul>
                            <li>Track FP rate per rule</li>
                            <li>Establish tuning SLAs</li>
                            <li>Create tuning tickets</li>
                            <li>Update watchlists regularly</li>
                            <li>Disable persistent FP rules</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ“Š Rule Health</div>
                    <div class="card-body">
                        <ul>
                            <li>Monitor rule execution success</li>
                            <li>Alert on rule failures</li>
                            <li>Track data source dependencies</li>
                            <li>Validate after connector changes</li>
                            <li>Review SentinelHealth table</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3>Detection Rule Lifecycle</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">Rule Review Query</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Rules with high false positive rates
SecurityIncident
| where TimeGenerated > ago(30d)
| where Classification == "FalsePositive"
| summarize FPCount = count() by AlertProductNames
| join kind=leftouter (
    SecurityIncident
    | where TimeGenerated > ago(30d)
    | summarize TotalCount = count() by AlertProductNames
) on AlertProductNames
| extend FPRate = round(100.0 * FPCount / TotalCount, 1)
| where FPRate > 30
| project AlertProductNames, FPCount, TotalCount, FPRate
| sort by FPRate desc

// Rules with no incidents (may need review)
SentinelHealth
| where TimeGenerated > ago(7d)
| where SentinelResourceType == "Analytics Rule"
| where Status == "Success"
| summarize LastRun = max(TimeGenerated) by SentinelResourceName
| join kind=leftanti (
    SecurityIncident
    | where TimeGenerated > ago(30d)
    | distinct Title
) on $left.SentinelResourceName == $right.Title</pre>
                </div>
            </div>

            <h2 id="operations">SOC Operations</h2>

            <div class="ascii-diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SOC OPERATIONAL MODEL                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         TIER 1: TRIAGE                                   â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   RESPONSIBILITIES:                    SLAs:                             â”‚   â”‚
â”‚   â”‚   â€¢ Initial incident triage            â€¢ Acknowledge: 15 min (High)     â”‚   â”‚
â”‚   â”‚   â€¢ Basic investigation                â€¢ Acknowledge: 1 hr (Medium)     â”‚   â”‚
â”‚   â”‚   â€¢ False positive identification      â€¢ Triage: 30 min                  â”‚   â”‚
â”‚   â”‚   â€¢ Escalation to Tier 2               â€¢ Daily queue target: 20-30      â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                   Escalate                                      â”‚
â”‚                                        â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                       TIER 2: INVESTIGATION                              â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   RESPONSIBILITIES:                    SLAs:                             â”‚   â”‚
â”‚   â”‚   â€¢ Deep-dive investigation            â€¢ Investigation: 4 hrs (High)    â”‚   â”‚
â”‚   â”‚   â€¢ Threat hunting                     â€¢ Investigation: 24 hrs (Med)    â”‚   â”‚
â”‚   â”‚   â€¢ Containment actions                â€¢ Hunting: 40 hrs/month          â”‚   â”‚
â”‚   â”‚   â€¢ Rule tuning recommendations        â€¢ Tuning tickets: 5/week         â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                   Escalate                                      â”‚
â”‚                                        â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    TIER 3: INCIDENT RESPONSE                             â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   RESPONSIBILITIES:                    SLAs:                             â”‚   â”‚
â”‚   â”‚   â€¢ Major incident response            â€¢ Response: 1 hr (Critical)      â”‚   â”‚
â”‚   â”‚   â€¢ Forensic analysis                  â€¢ Containment: 4 hrs             â”‚   â”‚
â”‚   â”‚   â€¢ Eradication & recovery             â€¢ PIR: 5 business days           â”‚   â”‚
â”‚   â”‚   â€¢ Post-incident review               â€¢ On-call: 24/7                  â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚   SUPPORTING FUNCTIONS:                                                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚   â€¢ Detection Engineering: Rule development, MITRE mapping, tuning             â”‚
â”‚   â€¢ Threat Intelligence: IOC management, adversary tracking                    â”‚
â”‚   â€¢ Platform Engineering: Connector management, automation, costs              â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2 id="maturity">Maturity Model</h2>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Level</th>
                            <th>Characteristics</th>
                            <th>Goals</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Level 1: Initial</strong></td>
                            <td>Basic data collection, default rules, reactive response</td>
                            <td>Establish visibility, basic alerting</td>
                        </tr>
                        <tr>
                            <td><strong>Level 2: Developing</strong></td>
                            <td>Tuned rules, basic automation, documented procedures</td>
                            <td>Reduce noise, improve efficiency</td>
                        </tr>
                        <tr>
                            <td><strong>Level 3: Defined</strong></td>
                            <td>MITRE coverage, proactive hunting, metrics tracking</td>
                            <td>Comprehensive detection, measurable outcomes</td>
                        </tr>
                        <tr>
                            <td><strong>Level 4: Managed</strong></td>
                            <td>Advanced correlation, UEBA, threat intelligence integration</td>
                            <td>Predictive capabilities, low FP rate</td>
                        </tr>
                        <tr>
                            <td><strong>Level 5: Optimized</strong></td>
                            <td>ML-driven detection, continuous improvement, industry-leading metrics</td>
                            <td>Innovation, thought leadership</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2 id="metrics">Key Metrics Dashboard</h2>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - SOC Metrics</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// MTTA (Mean Time to Acknowledge)
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status != "New"
| extend MTTA = datetime_diff('minute', FirstModifiedTime, CreatedTime)
| summarize 
    AvgMTTA = avg(MTTA),
    MedianMTTA = percentile(MTTA, 50),
    P95MTTA = percentile(MTTA, 95)
    by Severity

// MTTR (Mean Time to Resolve)
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Closed"
| extend MTTR = datetime_diff('hour', ClosedTime, CreatedTime)
| summarize 
    AvgMTTR = avg(MTTR),
    MedianMTTR = percentile(MTTR, 50)
    by Severity

// False Positive Rate
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Closed"
| summarize 
    Total = count(),
    TruePositive = countif(Classification == "TruePositive"),
    FalsePositive = countif(Classification == "FalsePositive"),
    BenignPositive = countif(Classification == "BenignPositive")
| extend 
    TPRate = round(100.0 * TruePositive / Total, 1),
    FPRate = round(100.0 * FalsePositive / Total, 1)

// Detection Coverage (MITRE)
SecurityIncident
| where TimeGenerated > ago(90d)
| mv-expand Tactics
| summarize IncidentCount = count() by tostring(Tactics)
| sort by IncidentCount desc</pre>
                </div>
            </div>

            <h3>Target Metrics</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Target (High Severity)</th>
                            <th>Target (Medium)</th>
                            <th>Industry Benchmark</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>MTTA</strong></td>
                            <td>&lt;15 minutes</td>
                            <td>&lt;1 hour</td>
                            <td>30 minutes</td>
                        </tr>
                        <tr>
                            <td><strong>MTTR</strong></td>
                            <td>&lt;4 hours</td>
                            <td>&lt;24 hours</td>
                            <td>6 hours</td>
                        </tr>
                        <tr>
                            <td><strong>False Positive Rate</strong></td>
                            <td>&lt;20%</td>
                            <td>&lt;30%</td>
                            <td>25%</td>
                        </tr>
                        <tr>
                            <td><strong>MITRE Coverage</strong></td>
                            <td>&gt;70% of tactics</td>
                            <td>N/A</td>
                            <td>60%</td>
                        </tr>
                        <tr>
                            <td><strong>Incidents/Analyst/Day</strong></td>
                            <td>15-25</td>
                            <td>N/A</td>
                            <td>20</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="alert alert-info">
                <svg class="alert-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/>
                </svg>
                <div class="alert-content">
                    <div class="alert-title">Continuous Improvement</div>
                    <p class="alert-text">Review metrics weekly, conduct monthly tuning sessions, and perform quarterly MITRE coverage assessments. Use post-incident reviews to identify detection gaps and automation opportunities.</p>
                </div>
            </div>

            <footer class="footer">
                <div class="footer-content">
                    <svg class="footer-icon" viewBox="0 0 24 24">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                    Microsoft Sentinel Ultimate Guide
                </div>
            </footer>
        </div>
    </main>
    <script src="main.js"></script>
</body>
</html>
