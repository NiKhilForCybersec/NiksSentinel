<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workbooks - Microsoft Sentinel Guide</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
            </svg>
            Sentinel Guide
        </a>
        <ul class="navbar-nav">
            <li><a href="index.html">Home</a></li>
            <li><a href="architecture.html">Architecture</a></li>
            <li><a href="analytics-rules.html">Analytics</a></li>
            <li><a href="automation.html">Automation</a></li>
        </ul>
        <button class="mobile-toggle" aria-label="Toggle menu">
            <svg viewBox="0 0 24 24" fill="none">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
        </button>
    </nav>

    <aside class="sidebar">
        <div class="sidebar-section">
            <div class="sidebar-title">Getting Started</div>
            <ul class="sidebar-nav">
                <li><a href="index.html">Home</a></li>
                <li><a href="architecture.html">Architecture</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Detection & Analytics</div>
            <ul class="sidebar-nav">
                <li><a href="analytics-rules.html">Analytics Rules</a></li>
                <li><a href="connector-rules.html">Connector Rules</a></li>
                <li><a href="correlation-rules.html">Correlation Rules</a></li>
                <li><a href="kql-library.html">KQL Library</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Investigation & Response</div>
            <ul class="sidebar-nav">
                <li><a href="incidents.html">Incidents</a></li>
                <li><a href="automation.html">Automation & SOAR</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Intelligence & Analytics</div>
            <ul class="sidebar-nav">
                <li><a href="workbooks.html" class="active">Workbooks</a></li>
                <li><a href="threat-intelligence.html">Threat Intelligence</a></li>
                <li><a href="ueba.html">UEBA</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Management</div>
            <ul class="sidebar-nav">
                <li><a href="content-hub.html">Content Hub</a></li>
                <li><a href="costs.html">Pricing & Costs</a></li>
                <li><a href="best-practices.html">Best Practices</a></li>
            </ul>
        </div>
    </aside>

    <main class="main-content">
        <div class="content-container">
            <h1>Workbooks & Dashboards</h1>
            <p>Create interactive dashboards and reports using Azure Workbooks to visualize security data, track SOC metrics, and monitor Sentinel health.</p>

            <div class="toc">
                <div class="toc-title">On This Page</div>
                <ul class="toc-list">
                    <li><a href="#overview">Workbooks Overview</a></li>
                    <li><a href="#architecture">Workbook Architecture</a></li>
                    <li><a href="#built-in">Built-in Workbooks</a></li>
                    <li><a href="#creating">Creating Workbooks</a></li>
                    <li><a href="#components">Workbook Components</a></li>
                    <li><a href="#visualizations">Visualization Types</a></li>
                    <li><a href="#parameters">Parameters & Filters</a></li>
                    <li><a href="#templates">SOC Workbook Templates</a></li>
                    <li><a href="#executive">Executive Dashboards</a></li>
                    <li><a href="#health">Health Monitoring</a></li>
                    <li><a href="#sharing">Sharing & Export</a></li>
                    <li><a href="#best-practices">Best Practices</a></li>
                </ul>
            </div>

            <h2 id="overview">Workbooks Overview</h2>
            <p>Azure Workbooks provide a flexible canvas for creating interactive reports and dashboards that combine text, KQL queries, metrics, and parameters into rich visual reports.</p>

            <div class="card-grid">
                <div class="card">
                    <div class="card-title">ğŸ“Š Interactive Dashboards</div>
                    <div class="card-body">
                        <p>Build dynamic dashboards with drill-down capabilities, filters, and real-time data updates.</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ“ˆ Multiple Data Sources</div>
                    <div class="card-body">
                        <p>Combine Log Analytics, Azure Resource Graph, Azure Monitor metrics, and custom endpoints.</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ¨ Rich Visualizations</div>
                    <div class="card-body">
                        <p>Charts, grids, tiles, maps, and custom visualizations for comprehensive reporting.</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">ğŸ”— Shareable Reports</div>
                    <div class="card-body">
                        <p>Share workbooks across teams, pin to Azure dashboards, or export as templates.</p>
                    </div>
                </div>
            </div>

            <h2 id="architecture">Workbook Architecture</h2>

            <div class="ascii-diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          WORKBOOK ARCHITECTURE                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   DATA SOURCES                                                                   â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚    Log      â”‚  â”‚   Azure     â”‚  â”‚   Azure     â”‚  â”‚   Custom    â”‚           â”‚
â”‚   â”‚  Analytics  â”‚  â”‚  Resource   â”‚  â”‚   Monitor   â”‚  â”‚    JSON     â”‚           â”‚
â”‚   â”‚   (KQL)     â”‚  â”‚   Graph     â”‚  â”‚   Metrics   â”‚  â”‚  Endpoint   â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚          â”‚                â”‚                â”‚                â”‚                   â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                    â”‚                                             â”‚
â”‚                                    â–¼                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         WORKBOOK CANVAS                                  â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚   â”‚   â”‚                      PARAMETERS                                  â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   Time Range | Subscription | Workspace | Custom Filters         â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚   â”‚
â”‚   â”‚   â”‚    QUERY STEP       â”‚  â”‚   VISUALIZATION     â”‚                      â”‚   â”‚
â”‚   â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚                      â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ KQL Query         â”‚  â”‚ â€¢ Chart Type        â”‚                      â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ Data source       â”‚â”€â”€â”‚ â€¢ Column mapping    â”‚                      â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ Time range        â”‚  â”‚ â€¢ Formatting        â”‚                      â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ Variables         â”‚  â”‚ â€¢ Thresholds        â”‚                      â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚   â”‚
â”‚   â”‚   â”‚      TEXT           â”‚  â”‚      LINKS          â”‚                      â”‚   â”‚
â”‚   â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚                      â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ Markdown          â”‚  â”‚ â€¢ URL links         â”‚                      â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ HTML              â”‚  â”‚ â€¢ Workbook links    â”‚                      â”‚   â”‚
â”‚   â”‚   â”‚ â€¢ Parameter refs    â”‚  â”‚ â€¢ ARM actions       â”‚                      â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                             â”‚
â”‚                                    â–¼                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                           OUTPUTS                                        â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€                                                                â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚
â”‚   â”‚   â”‚  Interactive    â”‚  â”‚  Azure Portal   â”‚  â”‚   Exported      â”‚         â”‚   â”‚
â”‚   â”‚   â”‚   Dashboard     â”‚  â”‚   Dashboard     â”‚  â”‚   Template      â”‚         â”‚   â”‚
â”‚   â”‚   â”‚                 â”‚  â”‚    (Pinned)     â”‚  â”‚    (ARM/JSON)   â”‚         â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h2 id="built-in">Built-in Workbooks</h2>
            <p>Microsoft Sentinel includes numerous pre-built workbooks for common use cases.</p>

            <h3>Essential Security Workbooks</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Workbook</th>
                            <th>Purpose</th>
                            <th>Data Sources</th>
                            <th>Key Metrics</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Security Operations Efficiency</strong></td>
                            <td>SOC performance metrics</td>
                            <td>SecurityIncident, SecurityAlert</td>
                            <td>MTTA, MTTR, incidents by severity, closure rates</td>
                        </tr>
                        <tr>
                            <td><strong>Azure AD Sign-in Logs</strong></td>
                            <td>Authentication analysis</td>
                            <td>SigninLogs</td>
                            <td>Failed logins, risky sign-ins, locations, apps</td>
                        </tr>
                        <tr>
                            <td><strong>Azure AD Audit Logs</strong></td>
                            <td>Directory changes</td>
                            <td>AuditLogs</td>
                            <td>User/group changes, app registrations, role assignments</td>
                        </tr>
                        <tr>
                            <td><strong>Microsoft 365</strong></td>
                            <td>Office 365 activity</td>
                            <td>OfficeActivity</td>
                            <td>SharePoint, Exchange, Teams activity</td>
                        </tr>
                        <tr>
                            <td><strong>Azure Activity</strong></td>
                            <td>Azure resource operations</td>
                            <td>AzureActivity</td>
                            <td>Resource changes, deployments, access</td>
                        </tr>
                        <tr>
                            <td><strong>Threat Intelligence</strong></td>
                            <td>TI indicator management</td>
                            <td>ThreatIntelligenceIndicator</td>
                            <td>Indicators by type, matches, sources</td>
                        </tr>
                        <tr>
                            <td><strong>Data Collection Health</strong></td>
                            <td>Connector monitoring</td>
                            <td>Usage, Heartbeat</td>
                            <td>Ingestion volume, agent health, latency</td>
                        </tr>
                        <tr>
                            <td><strong>MITRE ATT&CK</strong></td>
                            <td>Detection coverage</td>
                            <td>SecurityAlert</td>
                            <td>Coverage by tactic/technique, gaps</td>
                        </tr>
                        <tr>
                            <td><strong>Entity Behavior</strong></td>
                            <td>UEBA visualization</td>
                            <td>BehaviorAnalytics</td>
                            <td>Anomalies, risk scores, user activity</td>
                        </tr>
                        <tr>
                            <td><strong>Investigation Insights</strong></td>
                            <td>Entity investigation</td>
                            <td>Multiple</td>
                            <td>User/host/IP activity timeline</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Installing Workbooks from Content Hub</h3>
            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">
                        Step 1: Navigate to Content Hub
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <p><strong>Path:</strong> Microsoft Sentinel â†’ Content hub</p>
                        <p>Filter by "Content type" = "Workbook" to see available workbooks.</p>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Step 2: Install Solution Package
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <p>Workbooks are typically bundled with solutions. Install the full solution to get:</p>
                        <ul>
                            <li>Data connectors</li>
                            <li>Analytics rules</li>
                            <li>Workbooks</li>
                            <li>Hunting queries</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Step 3: Access Installed Workbooks
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <p><strong>Path:</strong> Microsoft Sentinel â†’ Workbooks â†’ Templates tab</p>
                        <p>Click "View template" to preview or "Save" to create an editable copy in "My workbooks".</p>
                    </div>
                </div>
            </div>

            <h2 id="creating">Creating Workbooks</h2>

            <h3>Workbook Creation Workflow</h3>
            <div class="ascii-diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       WORKBOOK CREATION WORKFLOW                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   1. PLAN                    2. BUILD                    3. DEPLOY              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€               â”‚
â”‚                                                                                  â”‚
â”‚   â€¢ Define audience          â€¢ Add parameters            â€¢ Save workbook        â”‚
â”‚   â€¢ Identify data sources    â€¢ Create query steps        â€¢ Set permissions      â”‚
â”‚   â€¢ List key metrics         â€¢ Configure visuals         â€¢ Pin to dashboard     â”‚
â”‚   â€¢ Sketch layout            â€¢ Add text/links            â€¢ Share with team      â”‚
â”‚   â€¢ Plan interactivity       â€¢ Test with data            â€¢ Export template      â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   NEW WORKBOOK WIZARD                                                    â”‚   â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Microsoft Sentinel â†’ Workbooks â†’ Add workbook                          â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚   â”‚   â”‚  + Add  â”‚  â–¼ Add query  â”‚  â–¼ Add text  â”‚  â–¼ Add parameters      â”‚  â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚   â”‚
â”‚   â”‚   â”‚                                                                   â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  â”‚                    WORKBOOK CANVAS                           â”‚ â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  â”‚                                                              â”‚ â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  â”‚    Drag and drop components here                            â”‚ â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  â”‚                                                              â”‚ â”‚  â”‚   â”‚
â”‚   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚   â”‚
â”‚   â”‚   â”‚                                                                   â”‚  â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h3>Basic Workbook Structure</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JSON - Workbook Template Structure</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "# Security Operations Dashboard\n\nThis workbook provides SOC metrics and visibility."
      },
      "name": "header"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "name": "TimeRange",
            "type": 4,
            "defaultValue": "24h"
          }
        ]
      },
      "name": "parameters"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "SecurityIncident | summarize count() by Severity",
        "visualization": "piechart"
      },
      "name": "incidents-by-severity"
    }
  ]
}</pre>
                </div>
            </div>

            <h2 id="components">Workbook Components</h2>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Component Type</th>
                            <th>Type ID</th>
                            <th>Purpose</th>
                            <th>Common Uses</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Text</strong></td>
                            <td>1</td>
                            <td>Markdown/HTML content</td>
                            <td>Headers, descriptions, instructions</td>
                        </tr>
                        <tr>
                            <td><strong>Query</strong></td>
                            <td>3</td>
                            <td>KQL query with visualization</td>
                            <td>Charts, grids, tiles, maps</td>
                        </tr>
                        <tr>
                            <td><strong>Metrics</strong></td>
                            <td>4</td>
                            <td>Azure Monitor metrics</td>
                            <td>Resource performance, health</td>
                        </tr>
                        <tr>
                            <td><strong>Parameters</strong></td>
                            <td>9</td>
                            <td>User input controls</td>
                            <td>Time range, filters, dropdowns</td>
                        </tr>
                        <tr>
                            <td><strong>Links</strong></td>
                            <td>11</td>
                            <td>Navigation elements</td>
                            <td>Tabs, buttons, URLs</td>
                        </tr>
                        <tr>
                            <td><strong>Groups</strong></td>
                            <td>12</td>
                            <td>Container for components</td>
                            <td>Collapsible sections, layouts</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2 id="visualizations">Visualization Types</h2>

            <div class="ascii-diagram">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          VISUALIZATION TYPES                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   CHART TYPES                                                                    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                    â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚    TIME CHART       â”‚  â”‚    BAR CHART        â”‚  â”‚    PIE CHART        â”‚    â”‚
â”‚   â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚  â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚  â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚    â”‚
â”‚   â”‚         â•±\          â”‚  â”‚    â–ˆâ–ˆâ–ˆ              â”‚  â”‚       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â”‚    â”‚
â”‚   â”‚       â•±   \  â•±\     â”‚  â”‚    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ            â”‚  â”‚     â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆ        â”‚    â”‚
â”‚   â”‚     â•±      \/  \    â”‚  â”‚    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         â”‚  â”‚    â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆ       â”‚    â”‚
â”‚   â”‚   â•±            \    â”‚  â”‚    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       â”‚  â”‚     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â”‚    â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚                     â”‚    â”‚
â”‚   â”‚   Trends over time  â”‚  â”‚   Category compare  â”‚  â”‚   Distribution      â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚    AREA CHART       â”‚  â”‚   SCATTER CHART     â”‚  â”‚    HEATMAP          â”‚    â”‚
â”‚   â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚  â”‚    â”€â”€â”€â”€â”€â”€â”€          â”‚    â”‚
â”‚   â”‚        â–ˆâ–ˆâ–ˆâ–ˆ         â”‚  â”‚      â€¢   â€¢          â”‚  â”‚   â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆ        â”‚    â”‚
â”‚   â”‚      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         â”‚  â”‚    â€¢  â€¢  â€¢  â€¢       â”‚  â”‚   â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆ        â”‚    â”‚
â”‚   â”‚    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         â”‚  â”‚   â€¢    â€¢    â€¢       â”‚  â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â”‚    â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚   â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘        â”‚    â”‚
â”‚   â”‚   Cumulative data   â”‚  â”‚   Correlation       â”‚  â”‚   Density matrix    â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                  â”‚
â”‚   DATA DISPLAYS                                                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                  â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚    DATA GRID        â”‚  â”‚      TILES          â”‚  â”‚       MAP           â”‚    â”‚
â”‚   â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚  â”‚      â”€â”€â”€â”€â”€          â”‚  â”‚       â”€â”€â”€           â”‚    â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”     â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”  â”‚  â”‚     â•­â”€â”€â”€â”€â”€â•®         â”‚    â”‚
â”‚   â”‚   â”‚ A â”‚ B â”‚ C â”‚     â”‚  â”‚   â”‚ 142 â”‚ â”‚ 89  â”‚  â”‚  â”‚    â•± â€¢ â€¢   â•²        â”‚    â”‚
â”‚   â”‚   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤     â”‚  â”‚   â”‚Incidâ”‚ â”‚Alertâ”‚  â”‚  â”‚   â”‚  â€¢   â€¢  â”‚       â”‚    â”‚
â”‚   â”‚   â”‚ 1 â”‚ 2 â”‚ 3 â”‚     â”‚  â”‚   â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜  â”‚  â”‚    â•²   â€¢   â•±        â”‚    â”‚
â”‚   â”‚   â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜     â”‚  â”‚   Summary metrics   â”‚  â”‚     â•°â”€â”€â”€â”€â”€â•¯         â”‚    â”‚
â”‚   â”‚   Tabular data      â”‚  â”‚   KPI display       â”‚  â”‚   Geographic data   â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
            </div>

            <h3>Visualization Configuration</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JSON - Chart Configuration</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>{
  "type": 3,
  "content": {
    "version": "KqlItem/1.0",
    "query": "SecurityIncident\n| where TimeGenerated > ago(7d)\n| summarize Count = count() by bin(TimeGenerated, 1d)",
    "size": 0,
    "title": "Incidents Over Time",
    "timeContext": {
      "durationMs": 604800000
    },
    "queryType": 0,
    "resourceType": "microsoft.operationalinsights/workspaces",
    "visualization": "timechart",
    "chartSettings": {
      "showLegend": true,
      "xAxis": {
        "label": "Date"
      },
      "yAxis": {
        "label": "Incident Count"
      },
      "seriesLabelSettings": [
        {
          "seriesName": "Count",
          "color": "#0078d4"
        }
      ]
    }
  }
}</pre>
                </div>
            </div>

            <h3>Grid with Conditional Formatting</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JSON - Grid with Thresholds</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>{
  "visualization": "table",
  "gridSettings": {
    "formatters": [
      {
        "columnMatch": "Severity",
        "formatter": 18,
        "formatOptions": {
          "thresholdsOptions": "icons",
          "thresholdsGrid": [
            {
              "operator": "==",
              "thresholdValue": "High",
              "representation": "4",
              "text": "{0}{1}"
            },
            {
              "operator": "==",
              "thresholdValue": "Medium",
              "representation": "2",
              "text": "{0}{1}"
            },
            {
              "operator": "==",
              "thresholdValue": "Low",
              "representation": "1",
              "text": "{0}{1}"
            }
          ]
        }
      },
      {
        "columnMatch": "MTTR",
        "formatter": 8,
        "formatOptions": {
          "palette": "redGreen",
          "min": 0,
          "max": 24
        }
      }
    ]
  }
}</pre>
                </div>
            </div>

            <h2 id="parameters">Parameters & Filters</h2>
            <p>Parameters enable interactive filtering and drill-down capabilities.</p>

            <h3>Parameter Types</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Type ID</th>
                            <th>Description</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Text</strong></td>
                            <td>1</td>
                            <td>Free text input</td>
                            <td>Search term, username</td>
                        </tr>
                        <tr>
                            <td><strong>Drop-down</strong></td>
                            <td>2</td>
                            <td>Single/multi select from list</td>
                            <td>Severity, status</td>
                        </tr>
                        <tr>
                            <td><strong>Time Range</strong></td>
                            <td>4</td>
                            <td>Time picker</td>
                            <td>Last 24h, 7d, custom</td>
                        </tr>
                        <tr>
                            <td><strong>Resource</strong></td>
                            <td>5</td>
                            <td>Azure resource picker</td>
                            <td>Workspace, subscription</td>
                        </tr>
                        <tr>
                            <td><strong>Subscription</strong></td>
                            <td>6</td>
                            <td>Subscription selector</td>
                            <td>Multi-subscription reports</td>
                        </tr>
                        <tr>
                            <td><strong>Resource Type</strong></td>
                            <td>7</td>
                            <td>Resource type filter</td>
                            <td>VMs, storage accounts</td>
                        </tr>
                        <tr>
                            <td><strong>Location</strong></td>
                            <td>8</td>
                            <td>Azure region selector</td>
                            <td>Regional filtering</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Parameter Examples</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JSON - Time Range Parameter</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>{
  "type": 9,
  "content": {
    "version": "KqlParameterItem/1.0",
    "parameters": [
      {
        "id": "time-range",
        "version": "KqlParameterItem/1.0",
        "name": "TimeRange",
        "type": 4,
        "isRequired": true,
        "value": {
          "durationMs": 86400000
        },
        "typeSettings": {
          "selectableValues": [
            { "durationMs": 3600000, "displayName": "Last 1 hour" },
            { "durationMs": 14400000, "displayName": "Last 4 hours" },
            { "durationMs": 86400000, "displayName": "Last 24 hours" },
            { "durationMs": 604800000, "displayName": "Last 7 days" },
            { "durationMs": 2592000000, "displayName": "Last 30 days" }
          ]
        }
      }
    ]
  }
}</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">JSON - Dynamic Dropdown from Query</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>{
  "type": 9,
  "content": {
    "version": "KqlParameterItem/1.0",
    "parameters": [
      {
        "id": "severity-filter",
        "version": "KqlParameterItem/1.0",
        "name": "Severity",
        "type": 2,
        "isRequired": false,
        "multiSelect": true,
        "quote": "'",
        "delimiter": ",",
        "query": "SecurityIncident\n| distinct Severity\n| order by Severity asc",
        "typeSettings": {
          "additionalResourceOptions": [
            "value::all"
          ]
        },
        "defaultValue": "value::all"
      }
    ]
  }
}</pre>
                </div>
            </div>

            <h3>Using Parameters in Queries</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Query with Parameters</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Reference time range parameter
SecurityIncident
| where TimeGenerated {TimeRange}  // Uses time range picker
| where "{Severity}" == "value::all" or Severity in ({Severity})  // Uses dropdown
| where "{SearchTerm}" == "" or Title contains "{SearchTerm}"  // Uses text input
| summarize 
    Count = count(),
    AvgTimeToClose = avg(ClosedTime - CreatedTime)
    by Severity
| sort by Count desc</pre>
                </div>
            </div>

            <h2 id="templates">SOC Workbook Templates</h2>

            <h3>SOC Operations Dashboard</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Incident Summary Tiles</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Total Open Incidents (Tile)
SecurityIncident
| where Status != "Closed"
| summarize OpenIncidents = count()

// High Severity Open (Tile)
SecurityIncident
| where Status != "Closed"
| where Severity == "High"
| summarize HighSevOpen = count()

// Incidents Created Today (Tile)
SecurityIncident
| where TimeGenerated > startofday(now())
| summarize TodayIncidents = count()

// Average MTTR (Tile)
SecurityIncident
| where Status == "Closed"
| where TimeGenerated > ago(7d)
| extend MTTR_Hours = datetime_diff('hour', ClosedTime, CreatedTime)
| summarize AvgMTTR = round(avg(MTTR_Hours), 1)</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Analyst Workload</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Incidents by Analyst
SecurityIncident
| where TimeGenerated > ago(7d)
| where isnotempty(Owner.assignedTo)
| extend Analyst = tostring(Owner.assignedTo)
| summarize 
    Assigned = count(),
    Open = countif(Status != "Closed"),
    Closed = countif(Status == "Closed"),
    HighSev = countif(Severity == "High")
    by Analyst
| extend ClosureRate = round(100.0 * Closed / Assigned, 1)
| sort by Assigned desc</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Incident Trend by Severity</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>SecurityIncident
| where TimeGenerated > ago(30d)
| summarize Count = count() by bin(TimeGenerated, 1d), Severity
| render timechart</pre>
                </div>
            </div>

            <h3>Detection Efficacy Dashboard</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Rule Performance</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Top alerting rules
SecurityAlert
| where TimeGenerated > ago(7d)
| summarize 
    AlertCount = count(),
    UniqueEntities = dcount(Entities)
    by AlertName = ProductName, ProviderName
| top 20 by AlertCount desc

// Rule to incident conversion
let Alerts = SecurityAlert
    | where TimeGenerated > ago(7d)
    | summarize AlertCount = count() by AlertName = ProductName;
let Incidents = SecurityIncident
    | where TimeGenerated > ago(7d)
    | mv-expand AlertId = AlertIds
    | join kind=inner (SecurityAlert | project AlertId = SystemAlertId, AlertName = ProductName) on AlertId
    | summarize IncidentCount = dcount(IncidentNumber) by AlertName;
Alerts
| join kind=leftouter Incidents on AlertName
| extend ConversionRate = round(100.0 * coalesce(IncidentCount, 0) / AlertCount, 1)
| project AlertName, AlertCount, IncidentCount = coalesce(IncidentCount, 0), ConversionRate
| sort by AlertCount desc</pre>
                </div>
            </div>

            <h3>Data Ingestion Dashboard</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Ingestion Volume by Table</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Daily ingestion by table
Usage
| where TimeGenerated > ago(30d)
| where IsBillable == true
| summarize TotalGB = sum(Quantity) / 1024 by bin(TimeGenerated, 1d), DataType
| render timechart

// Top tables by volume
Usage
| where TimeGenerated > ago(7d)
| where IsBillable == true
| summarize TotalGB = round(sum(Quantity) / 1024, 2) by DataType
| top 15 by TotalGB desc
| render barchart

// Ingestion anomaly detection
Usage
| where TimeGenerated > ago(14d)
| where IsBillable == true
| summarize DailyGB = sum(Quantity) / 1024 by bin(TimeGenerated, 1d), DataType
| summarize AvgGB = avg(DailyGB), StdDev = stdev(DailyGB), MaxGB = max(DailyGB) by DataType
| where MaxGB > AvgGB + (2 * StdDev)  // Tables with anomalous spikes
| project DataType, AvgGB = round(AvgGB, 2), MaxGB = round(MaxGB, 2), Anomaly = round(MaxGB - AvgGB, 2)</pre>
                </div>
            </div>

            <h2 id="executive">Executive Dashboards</h2>
            <p>Create high-level dashboards for security leadership and executives.</p>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Weekly Security Summary</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// This Week vs Last Week Comparison
let ThisWeek = SecurityIncident
    | where TimeGenerated > ago(7d)
    | summarize 
        TW_Total = count(),
        TW_High = countif(Severity == "High"),
        TW_Closed = countif(Status == "Closed");
let LastWeek = SecurityIncident
    | where TimeGenerated between (ago(14d) .. ago(7d))
    | summarize 
        LW_Total = count(),
        LW_High = countif(Severity == "High"),
        LW_Closed = countif(Status == "Closed");
ThisWeek
| extend dummy = 1
| join kind=inner (LastWeek | extend dummy = 1) on dummy
| project 
    Metric = "Incidents",
    ThisWeek = TW_Total,
    LastWeek = LW_Total,
    Change = TW_Total - LW_Total,
    ChangePercent = round(100.0 * (TW_Total - LW_Total) / LW_Total, 1)
| union (
    ThisWeek
    | extend dummy = 1
    | join kind=inner (LastWeek | extend dummy = 1) on dummy
    | project 
        Metric = "High Severity",
        ThisWeek = TW_High,
        LastWeek = LW_High,
        Change = TW_High - LW_High,
        ChangePercent = round(100.0 * (TW_High - LW_High) / max_of(LW_High, 1), 1)
)</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - MITRE ATT&CK Coverage</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Detections by MITRE Tactic
SecurityAlert
| where TimeGenerated > ago(30d)
| mv-expand tactic = Tactics
| summarize Detections = count() by Tactic = tostring(tactic)
| order by Detections desc

// Coverage heatmap data
let AllTactics = datatable(Tactic:string)
    ["InitialAccess", "Execution", "Persistence", "PrivilegeEscalation", 
     "DefenseEvasion", "CredentialAccess", "Discovery", "LateralMovement",
     "Collection", "Exfiltration", "CommandAndControl", "Impact"];
let DetectedTactics = SecurityAlert
    | where TimeGenerated > ago(30d)
    | mv-expand tactic = Tactics
    | summarize Count = count() by Tactic = tostring(tactic);
AllTactics
| join kind=leftouter DetectedTactics on Tactic
| extend 
    Count = coalesce(Count, 0),
    Coverage = iff(Count > 0, "Covered", "Gap")
| project Tactic, Count, Coverage</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Risk Score Trending</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Organization risk score over time
let DailyMetrics = SecurityIncident
    | where TimeGenerated > ago(30d)
    | summarize 
        HighSev = countif(Severity == "High"),
        MedSev = countif(Severity == "Medium"),
        LowSev = countif(Severity == "Low"),
        OpenCount = countif(Status != "Closed")
        by Day = bin(TimeGenerated, 1d);
DailyMetrics
| extend RiskScore = (HighSev * 10) + (MedSev * 5) + (LowSev * 1) + (OpenCount * 2)
| project Day, RiskScore, HighSev, MedSev, LowSev
| render timechart</pre>
                </div>
            </div>

            <h2 id="health">Health Monitoring</h2>

            <h3>Connector Health</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Data Connector Status</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Last received data per table
union withsource=TableName *
| summarize LastReceived = max(TimeGenerated) by TableName
| extend 
    HoursAgo = datetime_diff('hour', now(), LastReceived),
    Status = case(
        datetime_diff('hour', now(), LastReceived) < 1, "ğŸŸ¢ Healthy",
        datetime_diff('hour', now(), LastReceived) < 4, "ğŸŸ¡ Delayed",
        "ğŸ”´ Stale"
    )
| where TableName !startswith "_"
| sort by HoursAgo desc</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Agent Health</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Heartbeat status for monitored machines
Heartbeat
| summarize LastHeartbeat = max(TimeGenerated) by Computer, OSType
| extend 
    MinutesSinceHeartbeat = datetime_diff('minute', now(), LastHeartbeat),
    Status = case(
        datetime_diff('minute', now(), LastHeartbeat) < 15, "ğŸŸ¢ Online",
        datetime_diff('minute', now(), LastHeartbeat) < 60, "ğŸŸ¡ Delayed",
        "ğŸ”´ Offline"
    )
| sort by MinutesSinceHeartbeat desc</pre>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Analytics Rule Health</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Rule execution status
SentinelHealth
| where TimeGenerated > ago(24h)
| where OperationName == "Scheduled analytics rule run"
| extend 
    RuleName = tostring(ExtendedProperties.RuleName),
    Status = tostring(Status)
| summarize 
    Executions = count(),
    Failures = countif(Status == "Failure"),
    LastRun = max(TimeGenerated)
    by RuleName
| extend 
    FailureRate = round(100.0 * Failures / Executions, 1),
    Health = case(
        Failures == 0, "ğŸŸ¢ Healthy",
        FailureRate < 10, "ğŸŸ¡ Intermittent",
        "ğŸ”´ Failing"
    )
| sort by FailureRate desc</pre>
                </div>
            </div>

            <h2 id="sharing">Sharing & Export</h2>

            <h3>Sharing Options</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Access Level</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>My Workbooks (Private)</strong></td>
                            <td>Owner only</td>
                            <td>Personal dashboards, drafts</td>
                        </tr>
                        <tr>
                            <td><strong>Shared Workbooks</strong></td>
                            <td>Resource group RBAC</td>
                            <td>Team dashboards</td>
                        </tr>
                        <tr>
                            <td><strong>Pin to Azure Dashboard</strong></td>
                            <td>Dashboard viewers</td>
                            <td>Executive views, NOC displays</td>
                        </tr>
                        <tr>
                            <td><strong>Export as Template</strong></td>
                            <td>ARM template</td>
                            <td>Version control, deployment</td>
                        </tr>
                        <tr>
                            <td><strong>Gallery Template</strong></td>
                            <td>Org-wide</td>
                            <td>Standard reports</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Export Workbook as ARM Template</h3>
            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">
                        Export Steps
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <ol>
                            <li>Open workbook in edit mode</li>
                            <li>Click "Advanced Editor" (</> icon)</li>
                            <li>Switch to "Gallery Template" tab</li>
                            <li>Copy JSON content</li>
                            <li>Save to Git repository for version control</li>
                        </ol>
                    </div>
                </div>
            </div>

            <h2 id="best-practices">Best Practices</h2>

            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">
                        Performance Optimization
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Limit time ranges:</strong> Default to shorter time ranges (24h, 7d)</li>
                            <li><strong>Use summarize:</strong> Aggregate data before visualization</li>
                            <li><strong>Avoid select *:</strong> Project only needed columns</li>
                            <li><strong>Use materialized views:</strong> For frequently queried aggregations</li>
                            <li><strong>Cache parameters:</strong> Use dynamic dropdown caching</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Design Guidelines
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Lead with summary:</strong> Key metrics at top, details below</li>
                            <li><strong>Use consistent colors:</strong> Red=critical, yellow=warning, green=healthy</li>
                            <li><strong>Group related content:</strong> Use tabs or collapsible sections</li>
                            <li><strong>Add context:</strong> Include text explanations for metrics</li>
                            <li><strong>Enable drill-down:</strong> Link to detailed views</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Maintenance
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>Version control:</strong> Export templates to Git</li>
                            <li><strong>Document queries:</strong> Add comments explaining logic</li>
                            <li><strong>Test with data:</strong> Verify queries return expected results</li>
                            <li><strong>Review regularly:</strong> Update for schema changes</li>
                            <li><strong>Monitor performance:</strong> Check query execution times</li>
                        </ul>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        Audience-Specific Design
                        <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                    </button>
                    <div class="accordion-content">
                        <ul>
                            <li><strong>SOC Analysts:</strong> Operational details, investigation tools, real-time data</li>
                            <li><strong>SOC Managers:</strong> Team metrics, workload distribution, SLA tracking</li>
                            <li><strong>Executives:</strong> High-level KPIs, trends, risk posture</li>
                            <li><strong>IT Operations:</strong> Infrastructure health, ingestion status</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="alert alert-info">
                <svg class="alert-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/>
                </svg>
                <div class="alert-content">
                    <div class="alert-title">Pro Tips</div>
                    <p class="alert-text">Use the "Security Operations Efficiency" workbook as a starting point for SOC dashboards. Export workbooks as ARM templates and store in Git for version control. Pin critical metrics to Azure Dashboards for NOC display screens.</p>
                </div>
            </div>

            <footer class="footer">
                <div class="footer-content">
                    <svg class="footer-icon" viewBox="0 0 24 24">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                    Microsoft Sentinel Ultimate Guide
                </div>
            </footer>
        </div>
    </main>
    <script src="main.js"></script>
</body>
</html>
