<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Threat Hunting Queries - Practical SPL and KQL queries for hunting common attack techniques.">
    <title>Hunting Queries | SIEM Mastery Guide</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
</head>
<body>
    <div class="page-wrapper">
        <button class="mobile-menu-toggle" aria-label="Toggle navigation menu">
            <div class="hamburger"><span></span><span></span><span></span></div>
        </button>
        <div class="sidebar-overlay"></div>
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="logo-icon">üõ°Ô∏è</div>
                    <div>
                        <div class="logo-text">SIEM Mastery</div>
                        <div class="logo-subtext">Documentation</div>
                    </div>
                </a>
            </div>
            
                        <nav class="sidebar-nav">
                <!-- Section 1: SIEM Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üìö</span>
                            <span>SIEM Fundamentals</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="1-1-introduction-to-siem.html" class="nav-item">1.1 Introduction to SIEM</a>
                        <a href="1-2-architecture-components.html" class="nav-item">1.2 Architecture & Components</a>
                        <a href="1-3-log-sources-onboarding.html" class="nav-item">1.3 Log Sources & Onboarding</a>
                        <a href="1-4-log-parsing-normalization.html" class="nav-item">1.4 Log Parsing & Normalization</a>
                        <a href="1-5-detection-engineering-fundamentals.html" class="nav-item">1.5 Detection Engineering</a>
                        <a href="1-6-soc-operations-siem.html" class="nav-item">1.6 SOC Operations & SIEM</a>
                    </div>
                </div>
                
                <!-- Section 2: Splunk Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üü¢</span>
                            <span>Splunk Fundamentals</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="2-1-splunk-architecture.html" class="nav-item">2.1 Splunk Architecture</a>
                        <a href="2-2-installation-configuration.html" class="nav-item">2.2 Installation & Configuration</a>
                        <a href="2-3-data-ingestion.html" class="nav-item">2.3 Data Ingestion</a>
                        <a href="2-4-index-management.html" class="nav-item">2.4 Index Management</a>
                        <a href="2-5-spl-fundamentals.html" class="nav-item">2.5 SPL Fundamentals</a>
                        <a href="2-6-spl-data-retrieval.html" class="nav-item">2.6 SPL Data Retrieval</a>
                        <a href="2-7-spl-transforming.html" class="nav-item">2.7 SPL Transforming</a>
                        <a href="2-8-spl-manipulation.html" class="nav-item">2.8 SPL Manipulation</a>
                        <a href="2-9-spl-advanced.html" class="nav-item">2.9 SPL Advanced</a>
                        <a href="2-10-search-optimization.html" class="nav-item">2.10 Search Optimization</a>
                    </div>
                </div>
                
                <!-- Section 3: Splunk Security Operations -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üîí</span>
                            <span>Splunk Security Ops</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="3-1-splunk-es-overview.html" class="nav-item">3.1 Enterprise Security Overview</a>
                        <a href="3-2-notable-events.html" class="nav-item">3.2 Notable Events</a>
                        <a href="3-3-correlation-searches.html" class="nav-item">3.3 Correlation Searches</a>
                        <a href="3-4-risk-based-alerting.html" class="nav-item">3.4 Risk-Based Alerting</a>
                        <a href="3-5-threat-intelligence.html" class="nav-item">3.5 Threat Intelligence</a>
                        <a href="3-6-asset-identity.html" class="nav-item">3.6 Asset & Identity</a>
                        <a href="3-7-security-dashboards.html" class="nav-item">3.7 Security Dashboards</a>
                        <a href="3-8-es-administration.html" class="nav-item">3.8 ES Administration</a>
                    </div>
                </div>
                
                <!-- Section 4: Splunk SOAR -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">‚ö°</span>
                            <span>Splunk SOAR</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="4-1-soar-overview.html" class="nav-item">4.1 SOAR Overview</a>
                        <a href="4-2-playbooks.html" class="nav-item">4.2 Playbooks</a>
                        <a href="4-3-apps-integrations.html" class="nav-item">4.3 Apps & Integrations</a>
                        <a href="4-4-case-management.html" class="nav-item">4.4 Case Management</a>
                    </div>
                </div>
                
                <!-- Section 5: Microsoft Sentinel Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üî∑</span>
                            <span>Sentinel Fundamentals</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="5-1-sentinel-architecture.html" class="nav-item">5.1 Sentinel Architecture</a>
                        <a href="5-2-log-analytics.html" class="nav-item">5.2 Log Analytics Workspace</a>
                        <a href="5-3-data-connectors.html" class="nav-item">5.3 Data Connectors</a>
                        <a href="5-4-kql-fundamentals.html" class="nav-item">5.4 KQL Fundamentals</a>
                        <a href="5-5-kql-advanced.html" class="nav-item">5.5 KQL Advanced</a>
                        <a href="5-6-analytics-rules.html" class="nav-item">5.6 Analytics Rules</a>
                        <a href="5-7-incidents-investigation.html" class="nav-item">5.7 Incidents & Investigation</a>
                        <a href="5-8-workbooks-reporting.html" class="nav-item">5.8 Workbooks & Reporting</a>
                    </div>
                </div>
                
                <!-- Section 6: Sentinel Security Operations -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üî∂</span>
                            <span>Sentinel Security Ops</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="6-1-automation-playbooks.html" class="nav-item">6.1 Automation & Playbooks</a>
                        <a href="6-2-watchlists-ti.html" class="nav-item">6.2 Watchlists & Threat Intel</a>
                        <a href="6-3-ueba.html" class="nav-item">6.3 UEBA</a>
                        <a href="6-4-sentinel-administration.html" class="nav-item">6.4 Sentinel Administration</a>
                    </div>
                </div>
                
                <!-- Section 7: SIEM Comparison -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üîÄ</span>
                            <span>SIEM Comparison</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="7-1-splunk-vs-sentinel.html" class="nav-item">7.1 Splunk vs Sentinel</a>
                        <a href="7-2-query-language-comparison.html" class="nav-item">7.2 SPL vs KQL</a>
                        <a href="7-3-migration-considerations.html" class="nav-item">7.3 Migration Guide</a>
                    </div>
                </div>
                
                <!-- Section 8: Detection Engineering -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üéØ</span>
                            <span>Detection Engineering</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="8-1-detection-development.html" class="nav-item">8.1 Detection Development</a>
                        <a href="8-2-mitre-attack.html" class="nav-item">8.2 MITRE ATT&CK</a>
                        <a href="8-3-sigma-rules.html" class="nav-item">8.3 SIGMA Rules</a>
                        <a href="8-4-detection-testing.html" class="nav-item">8.4 Testing & Validation</a>
                    </div>
                </div>
                
                <!-- Section 9: Threat Hunting -->
                <div class="nav-section expanded">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üîç</span>
                            <span>Threat Hunting</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="9-1-hunting-fundamentals.html" class="nav-item">9.1 Hunting Fundamentals</a>
                        <a href="9-2-hunting-methodologies.html" class="nav-item">9.2 Hunting Methodologies</a>
                        <a href="9-3-hunting-queries.html" class="nav-item active">9.3 Hunting Queries</a>
                    </div>
                </div>
                
                <!-- Section 10: Use Case Library -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üìÅ</span>
                            <span>Use Case Library</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="10-1-authentication-attacks.html" class="nav-item">10.1 Authentication Attacks</a>
                        <a href="10-2-malware-execution.html" class="nav-item">10.2 Malware & Execution</a>
                        <a href="10-3-data-exfiltration.html" class="nav-item">10.3 Data Exfiltration</a>
                        <a href="10-4-insider-threats.html" class="nav-item">10.4 Insider Threats</a>
                    </div>
                </div>
                <!-- Appendices -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üìñ</span>
                            <span>Appendices</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="a-1-windows-security-fundamentals.html" class="nav-item">A.1 Windows Security</a>
                        <a href="a-2-network-fundamentals.html" class="nav-item">A.2 Network Fundamentals</a>
                        <a href="a-3-use-case-development.html" class="nav-item">A.3 Use Case Development</a>
                        <a href="a-4-siem-migration-guide.html" class="nav-item">A.4 SIEM Migration Guide</a>
                        <a href="a-5-siem-design-from-scratch.html" class="nav-item">A.5 Design from Scratch</a>
                    </div>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <p>Built for Security Engineers</p>
            </div>
        </aside>
        
        <main class="main-content">
            <header class="content-header">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <a href="9-1-hunting-fundamentals.html">Threat Hunting</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">Hunting Queries</span>
                </nav>
            </header>
            
            <div class="content-area">
                <h1 class="page-title">Hunting Queries Library</h1>
                <p class="page-subtitle">Practical SPL and KQL queries for common hunting scenarios</p>
                
                <div class="info-box overview">
                    <div class="info-box-header">
                        <span class="info-box-icon">üìò</span>
                        Chapter Overview
                    </div>
                    <div class="info-box-content">
                        <p>
                            This chapter provides ready-to-use hunting queries for both Splunk (SPL) and Microsoft Sentinel (KQL), organized by MITRE ATT&CK tactic. Each query includes explanation and tuning guidance.
                        </p>
                    </div>
                </div>
                
                <h2 id="execution">Execution (TA0002)</h2>
                
                <h3>PowerShell Encoded Commands</h3>
                
                <pre><code class="language-text">HUNT: T1059.001 - PowerShell with Encoded Commands</code></pre>
                
                <pre><code class="language-kql">// KQL - Sentinel
DeviceProcessEvents
| where TimeGenerated > ago(7d)
| where FileName =~ "powershell.exe" or FileName =~ "pwsh.exe"
| where ProcessCommandLine contains "-enc" 
    or ProcessCommandLine contains "-EncodedCommand"
    or ProcessCommandLine contains "FromBase64String"
| project TimeGenerated, DeviceName, AccountName, ProcessCommandLine
| extend DecodedLength = strlen(ProcessCommandLine)</code></pre>
                
                <pre><code class="language-text">// SPL - Splunk
index=windows sourcetype=WinEventLog:Security EventCode=4688
| where match(New_Process_Name, "(?i)powershell|pwsh")
| where match(Process_Command_Line, "(?i)(-enc|-encodedcommand|frombase64)")
| table _time, host, Account_Name, Process_Command_Line</code></pre>
                
                <h3>Suspicious Script Interpreters</h3>
                
                <pre><code class="language-kql">// KQL - Unusual script execution
DeviceProcessEvents
| where TimeGenerated > ago(7d)
| where FileName in~ ("cscript.exe", "wscript.exe", "mshta.exe", "regsvr32.exe")
| where ProcessCommandLine contains "http" 
    or ProcessCommandLine contains "//"
    or ProcessCommandLine contains "scrobj"
| project TimeGenerated, DeviceName, FileName, ProcessCommandLine, 
    InitiatingProcessFileName</code></pre>
                
                <h2 id="persistence">Persistence (TA0003)</h2>
                
                <h3>Scheduled Task Hunting</h3>
                
                <pre><code class="language-kql">// KQL - Suspicious scheduled tasks
SecurityEvent
| where TimeGenerated > ago(7d)
| where EventID == 4698  // Task created
| extend TaskContent = tostring(EventData.TaskContent)
| where TaskContent contains "powershell" 
    or TaskContent contains "cmd.exe"
    or TaskContent contains "\\AppData\\"
    or TaskContent contains "\\Temp\\"
| project TimeGenerated, Computer, SubjectUserName, 
    TaskName = tostring(EventData.TaskName), TaskContent</code></pre>
                
                <pre><code class="language-text">// SPL - Scheduled task creation
index=windows sourcetype=WinEventLog:Security EventCode=4698
| rex field=TaskContent "&lt;Command&gt;(?&lt;Command&gt;[^&lt;]+)&lt;/Command&gt;"
| where match(Command, "(?i)(powershell|cmd\.exe|temp|appdata)")
| table _time, host, SubjectUserName, TaskName, Command</code></pre>
                
                <h3>Registry Run Key Persistence</h3>
                
                <pre><code class="language-kql">// KQL - Registry persistence
DeviceRegistryEvents
| where TimeGenerated > ago(7d)
| where ActionType == "RegistryValueSet"
| where RegistryKey has_any (
    "\\CurrentVersion\\Run",
    "\\CurrentVersion\\RunOnce",
    "\\CurrentVersion\\Explorer\\Shell Folders"
)
| where RegistryValueData !contains "Microsoft"
| project TimeGenerated, DeviceName, RegistryKey, 
    RegistryValueName, RegistryValueData, InitiatingProcessFileName</code></pre>
                
                <h2 id="credential-access">Credential Access (TA0006)</h2>
                
                <h3>LSASS Access Hunting</h3>
                
                <pre><code class="language-kql">// KQL - Processes accessing LSASS
DeviceEvents
| where TimeGenerated > ago(7d)
| where ActionType == "OpenProcess"
| where FileName =~ "lsass.exe"
| where InitiatingProcessFileName !in~ (
    "csrss.exe", "lsm.exe", "services.exe", "svchost.exe",
    "WerFault.exe", "taskmgr.exe", "MsMpEng.exe"
)
| project TimeGenerated, DeviceName, 
    AccessingProcess = InitiatingProcessFileName,
    AccessingPath = InitiatingProcessFolderPath,
    InitiatingProcessAccountName
| summarize Count = count(), FirstSeen = min(TimeGenerated) 
    by DeviceName, AccessingProcess, AccessingPath</code></pre>
                
                <h3>Credential Dumping Tool Patterns</h3>
                
                <pre><code class="language-kql">// KQL - Known credential tool patterns
DeviceProcessEvents
| where TimeGenerated > ago(7d)
| where ProcessCommandLine has_any (
    "sekurlsa::", "kerberos::", "lsadump::",
    "privilege::debug", "token::elevate",
    "procdump", "-ma lsass",
    "comsvcs.dll", "MiniDump"
)
| project TimeGenerated, DeviceName, AccountName, 
    FileName, ProcessCommandLine</code></pre>
                
                <pre><code class="language-text">// SPL - Credential dumping patterns
index=windows sourcetype=WinEventLog:Security EventCode=4688
| where match(Process_Command_Line, "(?i)(sekurlsa|lsadump|mimikatz|procdump.*lsass|comsvcs.*minidump)")
| table _time, host, Account_Name, Creator_Process_Name, Process_Command_Line</code></pre>
                
                <h3>Password Spray Detection</h3>
                
                <pre><code class="language-kql">// KQL - Password spray pattern
SigninLogs
| where TimeGenerated > ago(24h)
| where ResultType == "50126"  // Invalid password
| summarize 
    TargetedUsers = dcount(UserPrincipalName),
    UserList = make_set(UserPrincipalName, 20),
    Attempts = count()
    by IPAddress, bin(TimeGenerated, 10m)
| where TargetedUsers > 5
| where Attempts > 10</code></pre>
                
                <h2 id="discovery">Discovery (TA0007)</h2>
                
                <h3>AD Enumeration</h3>
                
                <pre><code class="language-kql">// KQL - Active Directory enumeration
DeviceProcessEvents
| where TimeGenerated > ago(7d)
| where FileName in~ ("net.exe", "net1.exe", "dsquery.exe", 
    "nltest.exe", "adfind.exe")
| where ProcessCommandLine has_any (
    "domain", "group", "user", "admin", "trust",
    "dclist", "domainlist"
)
| project TimeGenerated, DeviceName, AccountName, 
    FileName, ProcessCommandLine</code></pre>
                
                <h3>Network Discovery</h3>
                
                <pre><code class="language-kql">// KQL - Network scanning activity
DeviceNetworkEvents
| where TimeGenerated > ago(24h)
| summarize 
    UniqueDestPorts = dcount(RemotePort),
    UniqueDestIPs = dcount(RemoteIP),
    TotalConnections = count()
    by DeviceName, InitiatingProcessFileName, bin(TimeGenerated, 1h)
| where UniqueDestPorts > 50 or UniqueDestIPs > 100
| sort by UniqueDestPorts desc</code></pre>
                
                <h2 id="lateral-movement">Lateral Movement (TA0008)</h2>
                
                <h3>Unusual RDP Activity</h3>
                
                <pre><code class="language-kql">// KQL - Unusual RDP sources
let KnownRDPSources = SecurityEvent
| where TimeGenerated between (ago(30d) .. ago(1d))
| where EventID == 4624 and LogonType == 10
| distinct IpAddress;
SecurityEvent
| where TimeGenerated > ago(24h)
| where EventID == 4624 and LogonType == 10
| where IpAddress !in (KnownRDPSources)
| project TimeGenerated, Computer, Account, IpAddress, LogonTypeName</code></pre>
                
                <h3>PsExec and Remote Execution</h3>
                
                <pre><code class="language-kql">// KQL - PsExec-style execution
DeviceProcessEvents
| where TimeGenerated > ago(7d)
| where FileName =~ "psexec.exe" 
    or FileName =~ "psexesvc.exe"
    or (FileName =~ "cmd.exe" and ProcessCommandLine contains "\\\\")
| project TimeGenerated, DeviceName, AccountName, 
    FileName, ProcessCommandLine, InitiatingProcessFileName</code></pre>
                
                <pre><code class="language-text">// SPL - Remote service installation
index=windows sourcetype=WinEventLog:System EventCode=7045
| where match(Service_File_Name, "(?i)(psexe|cmd\.exe|powershell)")
| table _time, host, Service_Name, Service_File_Name, Service_Account</code></pre>
                
                <h2 id="exfiltration">Collection & Exfiltration (TA0009/TA0010)</h2>
                
                <h3>Large Data Transfers</h3>
                
                <pre><code class="language-kql">// KQL - Unusual outbound data volume
DeviceNetworkEvents
| where TimeGenerated > ago(24h)
| where RemoteIPType == "Public"
| summarize 
    TotalBytesSent = sum(SentBytes),
    UniqueDestinations = dcount(RemoteIP),
    Destinations = make_set(RemoteIP, 10)
    by DeviceName, InitiatingProcessFileName
| where TotalBytesSent > 100000000  // 100 MB
| sort by TotalBytesSent desc</code></pre>
                
                <h3>Cloud Storage Uploads</h3>
                
                <pre><code class="language-kql">// KQL - Uploads to cloud storage
DeviceNetworkEvents
| where TimeGenerated > ago(7d)
| where RemoteUrl has_any (
    "dropbox.com", "drive.google.com", "onedrive.live.com",
    "mega.nz", "sendspace.com", "wetransfer.com"
)
| summarize 
    TotalUploaded = sum(SentBytes),
    Connections = count()
    by DeviceName, AccountName, RemoteUrl
| where TotalUploaded > 10000000</code></pre>
                
                <h2 id="defense-evasion">Defense Evasion (TA0005)</h2>
                
                <h3>Log Clearing</h3>
                
                <pre><code class="language-kql">// KQL - Event log clearing
SecurityEvent
| where TimeGenerated > ago(7d)
| where EventID in (1102, 104)  // Security/System log cleared
| project TimeGenerated, Computer, Account, EventID, Activity</code></pre>
                
                <h3>Security Tool Tampering</h3>
                
                <pre><code class="language-kql">// KQL - Security service stopped
DeviceEvents
| where TimeGenerated > ago(7d)
| where ActionType == "ServiceStopped"
| where FileName has_any (
    "MsMpEng", "Sense", "WinDefend", 
    "Symantec", "McAfee", "CrowdStrike"
)
| project TimeGenerated, DeviceName, AccountName, 
    ServiceName = FileName, InitiatingProcessFileName</code></pre>
                
                <h2 id="anomaly-queries">Anomaly Detection Queries</h2>
                
                <h3>First-Time Process Execution</h3>
                
                <pre><code class="language-kql">// KQL - Processes never seen before
let Historical = DeviceProcessEvents
| where TimeGenerated between (ago(30d) .. ago(1d))
| distinct FileName;
DeviceProcessEvents
| where TimeGenerated > ago(24h)
| where FileName !in (Historical)
| summarize 
    FirstSeen = min(TimeGenerated),
    Hosts = dcount(DeviceName),
    HostList = make_set(DeviceName, 5)
    by FileName
| sort by FirstSeen desc</code></pre>
                
                <h3>Unusual Parent-Child Process</h3>
                
                <pre><code class="language-kql">// KQL - Rare parent-child relationships
DeviceProcessEvents
| where TimeGenerated > ago(7d)
| summarize Count = count() by 
    Parent = InitiatingProcessFileName, 
    Child = FileName
| where Count < 10
| where Parent !in ("svchost.exe", "services.exe", "explorer.exe")
| sort by Count asc
| take 100</code></pre>
                
                <h3>Off-Hours Activity</h3>
                
                <pre><code class="language-kql">// KQL - Activity outside business hours
SigninLogs
| where TimeGenerated > ago(7d)
| extend Hour = datetime_part("hour", TimeGenerated)
| extend DayOfWeek = dayofweek(TimeGenerated)
| where Hour < 6 or Hour > 20  // Before 6 AM or after 8 PM
| where DayOfWeek in (0d, 6d)  // Weekend
| summarize 
    OffHoursLogins = count(),
    UniqueIPs = dcount(IPAddress)
    by UserPrincipalName
| where OffHoursLogins > 5
| sort by OffHoursLogins desc</code></pre>
                
                <div class="info-box tip">
                    <div class="info-box-header">
                        <span class="info-box-icon">üí°</span>
                        Query Tuning Tips
                    </div>
                    <div class="info-box-content">
                        <p>
                            <strong>Reduce Noise:</strong><br>
                            ‚ñ° Add exclusions for known-good processes/paths<br>
                            ‚ñ° Whitelist legitimate admin tools<br>
                            ‚ñ° Filter by device/user groups<br><br>
                            
                            <strong>Improve Performance:</strong><br>
                            ‚ñ° Start with shorter time ranges<br>
                            ‚ñ° Add specific filters early in query<br>
                            ‚ñ° Summarize before joining<br><br>
                            
                            <strong>Validate Results:</strong><br>
                            ‚ñ° Cross-reference with other data sources<br>
                            ‚ñ° Check timing correlations<br>
                            ‚ñ° Verify with endpoint investigation
                        </p>
                    </div>
                </div>
                
                <div class="info-box interview">
                    <div class="info-box-header">
                        <span class="info-box-icon">üíº</span>
                        Interview Question
                    </div>
                    <div class="info-box-content">
                        <p>
                            <strong>"Give me an example of a threat hunting query you've used."</strong><br><br>
                            <strong>Example: Encoded PowerShell Hunt</strong><br><br>
                            
                            <strong>Hypothesis:</strong> Attackers may be using encoded PowerShell to evade detection.<br><br>
                            
                            <strong>Query (KQL):</strong><br>
                            <code>DeviceProcessEvents | where FileName =~ "powershell.exe" | where ProcessCommandLine contains "-enc" or ProcessCommandLine contains "FromBase64String"</code><br><br>
                            
                            <strong>What I look for:</strong><br>
                            ‚Ä¢ Base64-encoded command blocks<br>
                            ‚Ä¢ Download cradles (IEX, Invoke-WebRequest)<br>
                            ‚Ä¢ Unusual parent processes spawning PowerShell<br><br>
                            
                            <strong>Outcome:</strong> This hunt has helped me identify both malicious activity (C2 beacons) and legitimate but risky admin scripts that needed review.
                        </p>
                    </div>
                </div>
                
                <h2 id="summary">Chapter Summary</h2>
                
                <ul>
                    <li>Hunting queries organized by MITRE ATT&CK tactic</li>
                    <li>Both SPL and KQL examples provided</li>
                    <li>Key areas: execution, persistence, credential access, lateral movement</li>
                    <li>Anomaly queries find statistical outliers</li>
                    <li>Always tune queries for your environment</li>
                    <li>Convert successful hunts into automated detections</li>
                </ul>
                
                <div class="info-box tip">
                    <div class="info-box-header">
                        <span class="info-box-icon">üéâ</span>
                        Section Complete
                    </div>
                    <div class="info-box-content">
                        <p>
                            Congratulations! You've completed <strong>Section 9: Threat Hunting</strong>. You now understand hunting fundamentals, methodologies, and have a library of practical queries. Use these skills to proactively find threats in your environment.
                        </p>
                    </div>
                </div>
                
                <div class="page-navigation">
                    <a href="9-2-hunting-methodologies.html" class="nav-button prev">
                        <span class="nav-button-icon">‚Üê</span>
                        <div>
                            <span class="nav-button-label">Previous</span>
                            <span class="nav-button-title">Hunting Methodologies</span>
                        </div>
                    </a>
                    <a href="index.html" class="nav-button next">
                        <span class="nav-button-icon">‚Üí</span>
                        <div>
                            <span class="nav-button-label">Back to</span>
                            <span class="nav-button-title">Home</span>
                        </div>
                    </a>
                </div>
            </div>
        </main>
    </div>
    
    <script src="main.js"></script>
</body>
</html>
