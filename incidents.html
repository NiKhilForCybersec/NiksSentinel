<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incident Management - Microsoft Sentinel Guide</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
            </svg>
            Sentinel Guide
        </a>
        <ul class="navbar-nav">
            <li><a href="index.html">Home</a></li>
            <li><a href="architecture.html">Architecture</a></li>
            <li><a href="data-connectors.html">Connectors</a></li>
            <li><a href="analytics-rules.html">Analytics</a></li>
            <li><a href="kql-library.html">KQL Library</a></li>
            <li><a href="automation.html">Automation</a></li>
        </ul>
        <button class="mobile-toggle" aria-label="Toggle menu">
            <svg viewBox="0 0 24 24" fill="none">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
        </button>
    </nav>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-section">
            <div class="sidebar-title">Getting Started</div>
            <ul class="sidebar-nav">
                <li><a href="index.html">Home</a></li>
                <li><a href="architecture.html">Architecture</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Data Collection</div>
            <ul class="sidebar-nav">
                <li><a href="data-connectors.html">Data Connectors</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Detection & Analytics</div>
            <ul class="sidebar-nav">
                <li><a href="analytics-rules.html">Analytics Rules</a></li>
                <li><a href="connector-rules.html">Connector Rules</a></li>
                <li><a href="correlation-rules.html">Correlation Rules</a></li>
                <li><a href="kql-library.html">KQL Library</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Investigation & Response</div>
            <ul class="sidebar-nav">
                <li><a href="incidents.html" class="active">Incidents</a></li>
                <li><a href="automation.html">Automation & SOAR</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Intelligence & Analytics</div>
            <ul class="sidebar-nav">
                <li><a href="workbooks.html">Workbooks</a></li>
                <li><a href="threat-intelligence.html">Threat Intelligence</a></li>
                <li><a href="ueba.html">UEBA</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Management</div>
            <ul class="sidebar-nav">
                <li><a href="content-hub.html">Content Hub</a></li>
                <li><a href="costs.html">Pricing & Costs</a></li>
                <li><a href="best-practices.html">Best Practices</a></li>
            </ul>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="content-container">
            <h1>Incident Management</h1>
            <p>Master the incident lifecycle in Microsoft Sentinel, from creation through investigation to closure. Learn to use the investigation graph, entity pages, and SOC efficiency metrics.</p>

            <!-- Table of Contents -->
            <div class="toc">
                <div class="toc-title">On This Page</div>
                <ul class="toc-list">
                    <li><a href="#lifecycle">Incident Lifecycle</a></li>
                    <li><a href="#queue">Incident Queue Management</a></li>
                    <li><a href="#investigation">Investigation Graph</a></li>
                    <li><a href="#entities">Entity Investigation</a></li>
                    <li><a href="#triage">Triage Process</a></li>
                    <li><a href="#queries">Investigation Queries</a></li>
                    <li><a href="#metrics">SOC Metrics</a></li>
                </ul>
            </div>

            <!-- Incident Lifecycle -->
            <h2 id="lifecycle">Incident Lifecycle</h2>
            <p>Understanding the incident lifecycle is critical for efficient SOC operations and accurate metrics tracking.</p>

            <div class="ascii-diagram">
<pre>
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              INCIDENT LIFECYCLE                                              │
├─────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                              │
│   ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐             │
│   │          │    │          │    │          │    │          │    │          │             │
│   │   NEW    │───▶│  ACTIVE  │───▶│IN PROGRESS───▶│ RESOLVED │───▶│  CLOSED  │             │
│   │          │    │          │    │          │    │          │    │          │             │
│   └──────────┘    └──────────┘    └──────────┘    └──────────┘    └──────────┘             │
│        │              │                │               │               │                    │
│        │              │                │               │               │                    │
│        ▼              ▼                ▼               ▼               ▼                    │
│   ┌──────────────────────────────────────────────────────────────────────────────────────┐ │
│   │                                                                                       │ │
│   │  NEW         → Incident created, awaiting triage                                     │ │
│   │  ACTIVE      → Assigned to analyst, investigation started                            │ │
│   │  IN PROGRESS → Active investigation with findings                                    │ │
│   │  RESOLVED    → Investigation complete, awaiting closure                              │ │
│   │  CLOSED      → Incident closed with classification                                   │ │
│   │                                                                                       │ │
│   └──────────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                              │
│   CLOSURE CLASSIFICATIONS:                                                                  │
│   ────────────────────────                                                                  │
│                                                                                              │
│   ┌───────────────────┐  ┌───────────────────┐  ┌───────────────────┐                      │
│   │   TRUE POSITIVE   │  │  FALSE POSITIVE   │  │  BENIGN POSITIVE  │                      │
│   │   ───────────────│  │   ───────────────│  │   ───────────────│                      │
│   │                   │  │                   │  │                   │                      │
│   │  • Confirmed      │  │  • Incorrect      │  │  • Authorized     │                      │
│   │    malicious      │  │    detection      │  │    activity       │                      │
│   │  • Attack chain   │  │  • Tune rule      │  │  • Expected       │                      │
│   │    validated      │  │  • Add exclusion  │  │    behavior       │                      │
│   │  • Response       │  │  • Adjust         │  │  • No action      │                      │
│   │    executed       │  │    threshold      │  │    required       │                      │
│   │                   │  │                   │  │                   │                      │
│   └───────────────────┘  └───────────────────┘  └───────────────────┘                      │
│                                                                                              │
│   METRICS TO TRACK:                                                                         │
│   ─────────────────                                                                         │
│   • MTTA (Mean Time to Acknowledge) → NEW to ACTIVE                                         │
│   • MTTD (Mean Time to Detect) → Event occurrence to NEW                                    │
│   • MTTR (Mean Time to Respond) → NEW to CLOSED                                             │
│   • FP Rate → False Positives / Total Incidents                                             │
│                                                                                              │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
</pre>
            </div>

            <!-- Incident Queue -->
            <h2 id="queue">Incident Queue Management</h2>
            <p>Efficiently managing the incident queue is essential for SOC productivity. Use filters, sorting, and bulk operations.</p>

            <h3>Queue Filtering</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Filter</th>
                            <th>Purpose</th>
                            <th>Example Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Severity</strong></td>
                            <td>Critical, High, Medium, Low, Informational</td>
                            <td>Focus on High/Critical during limited staffing</td>
                        </tr>
                        <tr>
                            <td><strong>Status</strong></td>
                            <td>New, Active, In Progress, Resolved, Closed</td>
                            <td>View unassigned incidents (Status = New)</td>
                        </tr>
                        <tr>
                            <td><strong>Owner</strong></td>
                            <td>Assigned analyst</td>
                            <td>Review your assigned incidents</td>
                        </tr>
                        <tr>
                            <td><strong>Product</strong></td>
                            <td>MDE, MDI, MDO, Azure AD, Custom</td>
                            <td>Route Defender alerts to Tier 1</td>
                        </tr>
                        <tr>
                            <td><strong>MITRE Tactic</strong></td>
                            <td>ATT&CK framework tactic</td>
                            <td>Hunt for Initial Access incidents</td>
                        </tr>
                        <tr>
                            <td><strong>Entities</strong></td>
                            <td>Users, Hosts, IPs, Files</td>
                            <td>Find all incidents for specific user</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Bulk Operations</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - Bulk Update via API</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>// Get incidents to update
SecurityIncident
| where Status == "New"
| where Severity == "Low"
| where TimeGenerated < ago(7d)
| project IncidentNumber, IncidentName, Severity

// Use Logic App or API to bulk close:
// PATCH /subscriptions/{sub}/resourceGroups/{rg}/
//   providers/Microsoft.OperationalInsights/workspaces/{workspace}/
//   providers/Microsoft.SecurityInsights/incidents/{incidentId}
// Body: { "properties": { "status": "Closed", "classification": "FalsePositive" } }</pre>
                </div>
            </div>

            <!-- Investigation Graph -->
            <h2 id="investigation">Investigation Graph</h2>
            <p>The investigation graph visualizes relationships between alerts, entities, and related incidents for rapid context gathering.</p>

            <div class="ascii-diagram">
<pre>
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                           INVESTIGATION GRAPH                                                │
├─────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                              │
│                              ┌───────────────────┐                                          │
│                              │    INCIDENT       │                                          │
│                              │  Brute Force      │                                          │
│                              │  Attack Detected  │                                          │
│                              └─────────┬─────────┘                                          │
│                                        │                                                     │
│                    ┌───────────────────┼───────────────────┐                                │
│                    │                   │                   │                                │
│                    ▼                   ▼                   ▼                                │
│            ┌─────────────┐     ┌─────────────┐     ┌─────────────┐                          │
│            │   ALERT 1   │     │   ALERT 2   │     │   ALERT 3   │                          │
│            │  Failed     │     │  Successful │     │  Suspicious │                          │
│            │  Logins     │     │  Login      │     │  Activity   │                          │
│            └──────┬──────┘     └──────┬──────┘     └──────┬──────┘                          │
│                   │                   │                   │                                 │
│         ┌─────────┴─────────┐   ┌─────┴─────┐   ┌─────────┴─────────┐                       │
│         │                   │   │           │   │                   │                       │
│         ▼                   ▼   ▼           ▼   ▼                   ▼                       │
│   ┌───────────┐       ┌───────────┐   ┌───────────┐       ┌───────────┐                    │
│   │   USER    │       │    IP     │   │   HOST    │       │   FILE    │                    │
│   │ john@co   │       │ 1.2.3.4   │   │ WKSTN01   │       │ mal.exe   │                    │
│   │           │       │           │   │           │       │           │                    │
│   │ • Timeline│       │ • GeoIP   │   │ • Logs    │       │ • Hash    │                    │
│   │ • Risk    │       │ • TI Match│   │ • Alerts  │       │ • VT Score│                    │
│   │ • Groups  │       │ • Reputation   • Software│       │ • First   │                    │
│   └───────────┘       └───────────┘   └───────────┘       │   Seen    │                    │
│         │                   │               │             └───────────┘                    │
│         │                   │               │                                              │
│         └───────────────────┴───────────────┘                                              │
│                             │                                                               │
│                    RELATED INCIDENTS                                                        │
│                    ┌─────────────────┐                                                      │
│                    │  • Inc #1234    │                                                      │
│                    │  • Inc #1235    │                                                      │
│                    │  (Same entities)│                                                      │
│                    └─────────────────┘                                                      │
│                                                                                              │
│   GRAPH FEATURES:                                                                           │
│   ───────────────                                                                           │
│   • Click entity to expand timeline and related alerts                                      │
│   • Right-click to add to investigation or run playbook                                     │
│   • View entity insights (UEBA anomalies, TI matches)                                       │
│   • Link related incidents for unified investigation                                        │
│   • Export graph for documentation                                                          │
│                                                                                              │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
</pre>
            </div>

            <!-- Entity Investigation -->
            <h2 id="entities">Entity Investigation</h2>
            <p>Entity pages provide comprehensive context for users, hosts, IPs, and other entity types.</p>

            <h3>User Entity Page</h3>
            <div class="card-grid">
                <div class="card">
                    <div class="card-title">Identity Info</div>
                    <div class="card-body">
                        <ul>
                            <li>UPN, Display Name, SID</li>
                            <li>Department, Manager</li>
                            <li>Group Memberships</li>
                            <li>Privileged Role Assignments</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">Risk Score</div>
                    <div class="card-body">
                        <ul>
                            <li>UEBA Investigation Priority</li>
                            <li>Identity Protection Risk Level</li>
                            <li>Recent Anomalies</li>
                            <li>Peer Comparison</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">Activity Timeline</div>
                    <div class="card-body">
                        <ul>
                            <li>Sign-in History</li>
                            <li>File Access</li>
                            <li>Email Activity</li>
                            <li>Admin Actions</li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">Related Incidents</div>
                    <div class="card-body">
                        <ul>
                            <li>Open Incidents</li>
                            <li>Historical Incidents</li>
                            <li>Alerts by Severity</li>
                            <li>Related Users</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3>Entity Investigation Queries</h3>
            <div class="code-block">
                <div class="code-header">
                    <span class="code-lang">KQL - User Investigation</span>
                    <button class="copy-btn">Copy</button>
                </div>
                <div class="code-content">
<pre>let targetUser = "john.doe@company.com";
let lookback = 7d;
// Sign-in Activity
let signins = SigninLogs
| where TimeGenerated > ago(lookback)
| where UserPrincipalName =~ targetUser
| summarize 
    TotalSignins = count(),
    SuccessfulSignins = countif(ResultType == "0"),
    FailedSignins = countif(ResultType != "0"),
    UniqueIPs = dcount(IPAddress),
    UniqueLocations = dcount(Location),
    UniqueApps = dcount(AppDisplayName)
| extend User = targetUser;
// Risky Sign-ins
let riskySignins = SigninLogs
| where TimeGenerated > ago(lookback)
| where UserPrincipalName =~ targetUser
| where RiskLevelDuringSignIn in ("high", "medium")
| project TimeGenerated, IPAddress, Location, AppDisplayName, RiskLevelDuringSignIn;
// Email Activity
let emailActivity = EmailEvents
| where TimeGenerated > ago(lookback)
| where SenderFromAddress =~ targetUser or RecipientEmailAddress =~ targetUser
| summarize 
    EmailsSent = countif(SenderFromAddress =~ targetUser),
    EmailsReceived = countif(RecipientEmailAddress =~ targetUser);
// Endpoint Activity
let endpointActivity = DeviceLogonEvents
| where TimeGenerated > ago(lookback)
| where AccountName has targetUser
| summarize 
    DevicesUsed = dcount(DeviceName),
    LogonCount = count()
    by DeviceName;
// Output
signins
| project-away User</pre>
                </div>
            </div>

            <!-- Triage Process -->
            <h2 id="triage">Triage Process</h2>
            <p>Standardized triage workflow ensures consistent handling and reduces mean time to acknowledge (MTTA).</p>

            <div class="ascii-diagram">
<pre>
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                              INCIDENT TRIAGE WORKFLOW                                        │
├─────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                              │
│   STEP 1: Initial Assessment (30 seconds)                                                   │
│   ────────────────────────────────────────                                                  │
│   □ Read incident title and description                                                     │
│   □ Check severity level                                                                    │
│   □ Review MITRE tactics/techniques                                                         │
│   □ Note affected entities (users, hosts, IPs)                                              │
│                                                                                              │
│   STEP 2: Context Gathering (2-5 minutes)                                                   │
│   ───────────────────────────────────────                                                   │
│   □ Open investigation graph                                                                │
│   □ Check entity pages for risk scores                                                      │
│   □ Review related incidents (same entities)                                                │
│   □ Check UEBA anomalies                                                                    │
│   □ Verify TI matches                                                                       │
│                                                                                              │
│   STEP 3: Decision Point                                                                    │
│   ──────────────────────                                                                    │
│                                                                                              │
│   ┌─────────────────┐         ┌─────────────────┐         ┌─────────────────┐              │
│   │  FALSE POSITIVE │         │ NEEDS ANALYSIS  │         │ CONFIRMED THREAT│              │
│   │                 │         │                 │         │                 │              │
│   │ • Known good    │         │ • Unclear       │         │ • Malicious     │              │
│   │ • Authorized    │         │ • Requires      │         │ • Active attack │              │
│   │ • Misconfigured │         │   deeper dive   │         │ • Immediate     │              │
│   │   rule          │         │ • Correlate     │         │   action needed │              │
│   │                 │         │   more data     │         │                 │              │
│   └────────┬────────┘         └────────┬────────┘         └────────┬────────┘              │
│            │                           │                           │                        │
│            ▼                           ▼                           ▼                        │
│   ┌─────────────────┐         ┌─────────────────┐         ┌─────────────────┐              │
│   │ Close with      │         │ Assign to       │         │ ESCALATE        │              │
│   │ classification  │         │ Tier 1/2 for    │         │ Trigger IR      │              │
│   │ + tuning ticket │         │ investigation   │         │ playbook        │              │
│   └─────────────────┘         └─────────────────┘         └─────────────────┘              │
│                                                                                              │
│   STEP 4: Documentation                                                                     │
│   ─────────────────────                                                                     │
│   □ Update incident comments with findings                                                  │
│   □ Link related incidents if applicable                                                    │
│   □ Record time spent for metrics                                                           │
│   □ Note any rule tuning needed                                                             │
│                                                                                              │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
</pre>
            </div>

            <!-- Investigation Queries -->
            <h2 id="queries">Investigation Queries</h2>
            <p>Common queries for incident investigation and context gathering.</p>

            <div class="rule-card">
                <div class="rule-header">
                    <h4 class="rule-title">Timeline Around Incident</h4>
                </div>
                <div class="rule-body">
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <div class="code-content">
<pre>let incidentTime = datetime(2024-01-15T10:30:00Z);
let targetHost = "WKSTN01";
let targetUser = "john.doe";
let windowBefore = 30m;
let windowAfter = 30m;
// Process events
DeviceProcessEvents
| where TimeGenerated between ((incidentTime - windowBefore) .. (incidentTime + windowAfter))
| where DeviceName =~ targetHost or AccountName has targetUser
| project 
    TimeGenerated,
    EventType = "Process",
    DeviceName,
    AccountName,
    Details = strcat(FileName, " | ", ProcessCommandLine)
// Network events
| union (
    DeviceNetworkEvents
    | where TimeGenerated between ((incidentTime - windowBefore) .. (incidentTime + windowAfter))
    | where DeviceName =~ targetHost
    | project 
        TimeGenerated,
        EventType = "Network",
        DeviceName,
        AccountName = InitiatingProcessAccountName,
        Details = strcat(RemoteIP, ":", RemotePort, " | ", InitiatingProcessFileName)
)
// File events
| union (
    DeviceFileEvents
    | where TimeGenerated between ((incidentTime - windowBefore) .. (incidentTime + windowAfter))
    | where DeviceName =~ targetHost
    | project 
        TimeGenerated,
        EventType = "File",
        DeviceName,
        AccountName = InitiatingProcessAccountName,
        Details = strcat(ActionType, " | ", FileName, " | ", FolderPath)
)
| sort by TimeGenerated asc</pre>
                        </div>
                    </div>
                </div>
            </div>

            <div class="rule-card">
                <div class="rule-header">
                    <h4 class="rule-title">Related Incidents Query</h4>
                </div>
                <div class="rule-body">
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <div class="code-content">
<pre>let targetEntity = "john.doe@company.com"; // User, IP, or hostname
SecurityIncident
| where TimeGenerated > ago(30d)
| mv-expand AlertIds
| join kind=inner (
    SecurityAlert
    | where TimeGenerated > ago(30d)
    | mv-expand Entities
    | extend EntityValue = tostring(Entities.UserPrincipalName)
    | where EntityValue =~ targetEntity
    | project AlertId = SystemAlertId
) on $left.AlertIds == $right.AlertId
| summarize 
    RelatedIncidents = dcount(IncidentNumber),
    Incidents = make_set(IncidentNumber),
    Severities = make_set(Severity)
    by IncidentName
| sort by RelatedIncidents desc</pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SOC Metrics -->
            <h2 id="metrics">SOC Metrics</h2>
            <p>Track key performance indicators to measure and improve SOC efficiency.</p>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Definition</th>
                            <th>Target</th>
                            <th>How to Improve</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>MTTA</strong></td>
                            <td>Mean Time to Acknowledge</td>
                            <td>&lt;15 min (High), &lt;1hr (Med)</td>
                            <td>Automation rules, shift coverage</td>
                        </tr>
                        <tr>
                            <td><strong>MTTD</strong></td>
                            <td>Mean Time to Detect</td>
                            <td>&lt;1 hour</td>
                            <td>NRT rules, better data sources</td>
                        </tr>
                        <tr>
                            <td><strong>MTTR</strong></td>
                            <td>Mean Time to Respond</td>
                            <td>&lt;4hr (High), &lt;24hr (Med)</td>
                            <td>Playbooks, analyst training</td>
                        </tr>
                        <tr>
                            <td><strong>FP Rate</strong></td>
                            <td>False Positive Rate</td>
                            <td>&lt;30%</td>
                            <td>Rule tuning, watchlists</td>
                        </tr>
                        <tr>
                            <td><strong>Incidents/Analyst</strong></td>
                            <td>Daily workload</td>
                            <td>15-25/day</td>
                            <td>Automation, reduce FPs</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="rule-card">
                <div class="rule-header">
                    <h4 class="rule-title">SOC Metrics Dashboard Query</h4>
                </div>
                <div class="rule-body">
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-lang">KQL</span>
                            <button class="copy-btn">Copy</button>
                        </div>
                        <div class="code-content">
<pre>// MTTR by severity
SecurityIncident
| where TimeGenerated > ago(30d)
| where Status == "Closed"
| extend 
    TimeToClose = datetime_diff('minute', ClosedTime, CreatedTime)
| summarize 
    AvgMTTR_Minutes = avg(TimeToClose),
    MedianMTTR = percentile(TimeToClose, 50),
    IncidentCount = count()
    by Severity
| extend AvgMTTR_Hours = round(AvgMTTR_Minutes / 60, 1)
| project Severity, AvgMTTR_Hours, MedianMTTR_Hours = round(MedianMTTR / 60, 1), IncidentCount

// False Positive Rate
| union (
    SecurityIncident
    | where TimeGenerated > ago(30d)
    | where Status == "Closed"
    | summarize 
        TotalClosed = count(),
        FalsePositives = countif(Classification == "FalsePositive"),
        TruePositives = countif(Classification == "TruePositive"),
        BenignPositives = countif(Classification == "BenignPositive")
    | extend FPRate = round(100.0 * FalsePositives / TotalClosed, 1)
)</pre>
                        </div>
                    </div>
                </div>
            </div>

            <div class="alert alert-info">
                <svg class="alert-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/>
                </svg>
                <div class="alert-content">
                    <div class="alert-title">Pro Tip</div>
                    <p class="alert-text">Use the built-in SOC Efficiency workbook (Content Hub) for pre-built dashboards tracking all these metrics over time.</p>
                </div>
            </div>

            <!-- Footer -->
            <footer class="footer">
                <div class="footer-content">
                    <svg class="footer-icon" viewBox="0 0 24 24">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                    Microsoft Sentinel Ultimate Guide
                </div>
            </footer>
        </div>
    </main>

    <script src="main.js"></script>
</body>
</html>
