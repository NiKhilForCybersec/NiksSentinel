<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Splunk Index Management - Index configuration, retention policies, bucket lifecycle, sizing, and SmartStore for cloud storage.">
    <title>Index Management | SIEM Mastery Guide</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
</head>
<body>
    <div class="page-wrapper">
        <button class="mobile-menu-toggle" aria-label="Toggle navigation menu">
            <div class="hamburger"><span></span><span></span><span></span></div>
        </button>
        <div class="sidebar-overlay"></div>
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <div class="logo-icon">üõ°Ô∏è</div>
                    <div>
                        <div class="logo-text">SIEM Mastery</div>
                        <div class="logo-subtext">Documentation</div>
                    </div>
                </a>
                <div class="sidebar-search">
                    <span class="search-icon">üîç</span>
                    <input type="text" placeholder="Search docs... (Ctrl+K)" aria-label="Search documentation">
                </div>
            </div>
            
                        <nav class="sidebar-nav">
                <!-- Section 1: SIEM Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üìö</span>
                            <span>SIEM Fundamentals</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="1-1-introduction-to-siem.html" class="nav-item">1.1 Introduction to SIEM</a>
                        <a href="1-2-architecture-components.html" class="nav-item">1.2 Architecture & Components</a>
                        <a href="1-3-log-sources-onboarding.html" class="nav-item">1.3 Log Sources & Onboarding</a>
                        <a href="1-4-log-parsing-normalization.html" class="nav-item">1.4 Log Parsing & Normalization</a>
                        <a href="1-5-detection-engineering-fundamentals.html" class="nav-item">1.5 Detection Engineering</a>
                        <a href="1-6-soc-operations-siem.html" class="nav-item">1.6 SOC Operations & SIEM</a>
                    </div>
                </div>
                
                <!-- Section 2: Splunk Fundamentals -->
                <div class="nav-section expanded">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üü¢</span>
                            <span>Splunk Fundamentals</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="2-1-splunk-architecture.html" class="nav-item">2.1 Splunk Architecture</a>
                        <a href="2-2-installation-configuration.html" class="nav-item">2.2 Installation & Configuration</a>
                        <a href="2-3-data-ingestion.html" class="nav-item">2.3 Data Ingestion</a>
                        <a href="2-4-index-management.html" class="nav-item active">2.4 Index Management</a>
                        <a href="2-5-spl-fundamentals.html" class="nav-item">2.5 SPL Fundamentals</a>
                        <a href="2-6-spl-data-retrieval.html" class="nav-item">2.6 SPL Data Retrieval</a>
                        <a href="2-7-spl-transforming.html" class="nav-item">2.7 SPL Transforming</a>
                        <a href="2-8-spl-manipulation.html" class="nav-item">2.8 SPL Manipulation</a>
                        <a href="2-9-spl-advanced.html" class="nav-item">2.9 SPL Advanced</a>
                        <a href="2-10-search-optimization.html" class="nav-item">2.10 Search Optimization</a>
                    </div>
                </div>
                
                <!-- Section 3: Splunk Security Operations -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üîí</span>
                            <span>Splunk Security Ops</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="3-1-splunk-es-overview.html" class="nav-item">3.1 Enterprise Security Overview</a>
                        <a href="3-2-notable-events.html" class="nav-item">3.2 Notable Events</a>
                        <a href="3-3-correlation-searches.html" class="nav-item">3.3 Correlation Searches</a>
                        <a href="3-4-risk-based-alerting.html" class="nav-item">3.4 Risk-Based Alerting</a>
                        <a href="3-5-threat-intelligence.html" class="nav-item">3.5 Threat Intelligence</a>
                        <a href="3-6-asset-identity.html" class="nav-item">3.6 Asset & Identity</a>
                        <a href="3-7-security-dashboards.html" class="nav-item">3.7 Security Dashboards</a>
                        <a href="3-8-es-administration.html" class="nav-item">3.8 ES Administration</a>
                    </div>
                </div>
                
                <!-- Section 4: Splunk SOAR -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">‚ö°</span>
                            <span>Splunk SOAR</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="4-1-soar-overview.html" class="nav-item">4.1 SOAR Overview</a>
                        <a href="4-2-playbooks.html" class="nav-item">4.2 Playbooks</a>
                        <a href="4-3-apps-integrations.html" class="nav-item">4.3 Apps & Integrations</a>
                        <a href="4-4-case-management.html" class="nav-item">4.4 Case Management</a>
                    </div>
                </div>
                
                <!-- Section 5: Microsoft Sentinel Fundamentals -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üî∑</span>
                            <span>Sentinel Fundamentals</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="5-1-sentinel-architecture.html" class="nav-item">5.1 Sentinel Architecture</a>
                        <a href="5-2-log-analytics.html" class="nav-item">5.2 Log Analytics Workspace</a>
                        <a href="5-3-data-connectors.html" class="nav-item">5.3 Data Connectors</a>
                        <a href="5-4-kql-fundamentals.html" class="nav-item">5.4 KQL Fundamentals</a>
                        <a href="5-5-kql-advanced.html" class="nav-item">5.5 KQL Advanced</a>
                        <a href="5-6-analytics-rules.html" class="nav-item">5.6 Analytics Rules</a>
                        <a href="5-7-incidents-investigation.html" class="nav-item">5.7 Incidents & Investigation</a>
                        <a href="5-8-workbooks-reporting.html" class="nav-item">5.8 Workbooks & Reporting</a>
                    </div>
                </div>
                
                <!-- Section 6: Sentinel Security Operations -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üî∂</span>
                            <span>Sentinel Security Ops</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="6-1-automation-playbooks.html" class="nav-item">6.1 Automation & Playbooks</a>
                        <a href="6-2-watchlists-ti.html" class="nav-item">6.2 Watchlists & Threat Intel</a>
                        <a href="6-3-ueba.html" class="nav-item">6.3 UEBA</a>
                        <a href="6-4-sentinel-administration.html" class="nav-item">6.4 Sentinel Administration</a>
                    </div>
                </div>
                
                <!-- Section 7: SIEM Comparison -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üîÄ</span>
                            <span>SIEM Comparison</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="7-1-splunk-vs-sentinel.html" class="nav-item">7.1 Splunk vs Sentinel</a>
                        <a href="7-2-query-language-comparison.html" class="nav-item">7.2 SPL vs KQL</a>
                        <a href="7-3-migration-considerations.html" class="nav-item">7.3 Migration Guide</a>
                    </div>
                </div>
                
                <!-- Section 8: Detection Engineering -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üéØ</span>
                            <span>Detection Engineering</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="8-1-detection-development.html" class="nav-item">8.1 Detection Development</a>
                        <a href="8-2-mitre-attack.html" class="nav-item">8.2 MITRE ATT&CK</a>
                        <a href="8-3-sigma-rules.html" class="nav-item">8.3 SIGMA Rules</a>
                        <a href="8-4-detection-testing.html" class="nav-item">8.4 Testing & Validation</a>
                    </div>
                </div>
                
                <!-- Section 9: Threat Hunting -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üîç</span>
                            <span>Threat Hunting</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="9-1-hunting-fundamentals.html" class="nav-item">9.1 Hunting Fundamentals</a>
                        <a href="9-2-hunting-methodologies.html" class="nav-item">9.2 Hunting Methodologies</a>
                        <a href="9-3-hunting-queries.html" class="nav-item">9.3 Hunting Queries</a>
                    </div>
                </div>
                
                <!-- Section 10: Use Case Library -->
                <div class="nav-section">
                    <div class="nav-section-header">
                        <span class="nav-section-title">
                            <span class="nav-section-icon">üìÅ</span>
                            <span>Use Case Library</span>
                        </span>
                        <span class="nav-section-arrow">‚ñ∂</span>
                    </div>
                    <div class="nav-section-items">
                        <a href="10-1-authentication-attacks.html" class="nav-item">10.1 Authentication Attacks</a>
                        <a href="10-2-malware-execution.html" class="nav-item">10.2 Malware & Execution</a>
                        <a href="10-3-data-exfiltration.html" class="nav-item">10.3 Data Exfiltration</a>
                        <a href="10-4-insider-threats.html" class="nav-item">10.4 Insider Threats</a>
                    </div>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <p>Built for Security Engineers</p>
            </div>
        </aside>
        
        <main class="main-content">
            <header class="content-header">
                <nav class="breadcrumb">
                    <a href="index.html">Home</a>
                    <span class="breadcrumb-separator">/</span>
                    <a href="2-1-splunk-architecture.html">Splunk Fundamentals</a>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-current">Index Management</span>
                </nav>
            </header>
            
            <div class="content-area">
                <h1 class="page-title">Index Management</h1>
                <p class="page-subtitle">Creating indexes, configuring retention, understanding buckets, and optimizing storage</p>
                
                <div class="info-box overview">
                    <div class="info-box-header">
                        <span class="info-box-icon">üìò</span>
                        Chapter Overview
                    </div>
                    <div class="info-box-content">
                        <p>
                            Indexes are where Splunk stores your data. This chapter covers index creation and configuration, retention policies, the bucket lifecycle, capacity planning, and SmartStore for cost-effective cloud storage.
                        </p>
                    </div>
                </div>
                
                <h2 id="index-basics">Index Fundamentals</h2>
                
                <p>
                    An index is a repository for Splunk data. Each index contains:
                </p>
                
                <ul>
                    <li><strong>Raw data</strong> - Compressed original events</li>
                    <li><strong>Index files</strong> - Searchable metadata (tsidx files)</li>
                    <li><strong>Bloom filters</strong> - Quick existence checks</li>
                </ul>
                
                <h3>Default Indexes</h3>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Index</th>
                                <th>Purpose</th>
                                <th>Contents</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>main</strong></td>
                                <td>Default data index</td>
                                <td>User data if no index specified</td>
                            </tr>
                            <tr>
                                <td><strong>_internal</strong></td>
                                <td>Splunk internal logs</td>
                                <td>Splunk metrics, logs, performance data</td>
                            </tr>
                            <tr>
                                <td><strong>_audit</strong></td>
                                <td>Audit trail</td>
                                <td>User actions, search history</td>
                            </tr>
                            <tr>
                                <td><strong>_introspection</strong></td>
                                <td>System introspection</td>
                                <td>Resource usage, performance metrics</td>
                            </tr>
                            <tr>
                                <td><strong>_telemetry</strong></td>
                                <td>Usage telemetry</td>
                                <td>Anonymous usage data (if enabled)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2 id="creating-indexes">Creating Indexes</h2>
                
                <h3>Via indexes.conf</h3>
                
                <pre><code class="language-ini"># $SPLUNK_HOME/etc/system/local/indexes.conf

# Basic index with defaults
[security]
homePath = $SPLUNK_DB/security/db
coldPath = $SPLUNK_DB/security/colddb
thawedPath = $SPLUNK_DB/security/thaweddb

# Security index with custom retention
[windows]
homePath = $SPLUNK_DB/windows/db
coldPath = $SPLUNK_DB/windows/colddb
thawedPath = $SPLUNK_DB/windows/thaweddb
# Retention: 90 days
frozenTimePeriodInSecs = 7776000
# Max size: 500GB
maxTotalDataSizeMB = 512000

# Network logs with shorter retention
[network]
homePath = $SPLUNK_DB/network/db
coldPath = $SPLUNK_DB/network/colddb
thawedPath = $SPLUNK_DB/network/thaweddb
# 30 days retention
frozenTimePeriodInSecs = 2592000
maxTotalDataSizeMB = 256000

# High-volume index with data model acceleration
[firewall]
homePath = $SPLUNK_DB/firewall/db
coldPath = $SPLUNK_DB/firewall/colddb
thawedPath = $SPLUNK_DB/firewall/thaweddb
frozenTimePeriodInSecs = 2592000
# Larger bucket sizes for high volume
maxDataSize = auto_high_volume
# Enable TSIDX reduction for older data
enableTsidxReduction = true
tsidxReductionCheckPeriodInSec = 86400</code></pre>
                
                <h3>Via CLI</h3>
                
                <pre><code class="language-bash"># Create index
splunk add index security -homePath /splunkdata/security/db \
  -coldPath /splunkdata/security/colddb \
  -thawedPath /splunkdata/security/thaweddb \
  -frozenTimePeriodInSecs 7776000

# List indexes
splunk list index

# Show index properties
splunk show index security</code></pre>
                
                <h3>Via Web UI</h3>
                
                <pre><code class="language-text">Settings ‚Üí Indexes ‚Üí New Index
- Index Name: security
- Home Path: $SPLUNK_DB/security/db
- Cold Path: $SPLUNK_DB/security/colddb
- Max Size: 500 GB
- Retention: 90 days</code></pre>
                
                <h2 id="retention-policies">Retention Policies</h2>
                
                <p>
                    Splunk offers two methods to control retention:
                </p>
                
                <h3>Time-Based Retention</h3>
                
                <pre><code class="language-ini"># Freeze data older than specified time
frozenTimePeriodInSecs = 7776000  # 90 days

# Calculation:
# 1 day = 86400 seconds
# 30 days = 2592000
# 90 days = 7776000
# 365 days = 31536000
# 2 years = 63072000</code></pre>
                
                <h3>Size-Based Retention</h3>
                
                <pre><code class="language-ini"># Maximum total index size
maxTotalDataSizeMB = 512000  # 500 GB

# When size limit reached, oldest data frozen first
# Size includes all buckets (hot, warm, cold)</code></pre>
                
                <h3>Retention Strategy</h3>
                
                <pre><code class="language-ini"># Recommended: Use BOTH time and size limits
# Time limit = compliance requirement
# Size limit = capacity protection

[security]
frozenTimePeriodInSecs = 31536000  # 1 year (compliance)
maxTotalDataSizeMB = 1024000       # 1 TB (capacity limit)

# Whichever triggers first will freeze data</code></pre>
                
                <div class="info-box best-practice">
                    <div class="info-box-header">
                        <span class="info-box-icon">‚úì</span>
                        Best Practice
                    </div>
                    <div class="info-box-content">
                        <p>
                            Set both time-based and size-based retention. Time-based ensures compliance requirements are met. Size-based prevents unexpected disk exhaustion. Always leave 15-20% free disk space as buffer.
                        </p>
                    </div>
                </div>
                
                <h2 id="bucket-lifecycle">Bucket Lifecycle</h2>
                
                <p>
                    Splunk stores data in "buckets" that progress through a lifecycle:
                </p>
                
                <pre><code class="language-text">BUCKET LIFECYCLE:

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     HOT     ‚îÇ  Actively receiving data
‚îÇ   (db/)     ‚îÇ  Writable, on fast storage
‚îÇ             ‚îÇ  One hot bucket per index
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ maxDataSize reached OR
       ‚îÇ maxHotSpanSecs exceeded
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    WARM     ‚îÇ  Searchable, read-only
‚îÇ   (db/)     ‚îÇ  Same location as hot
‚îÇ             ‚îÇ  Multiple warm buckets
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ maxWarmDBCount reached OR
       ‚îÇ age threshold
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    COLD     ‚îÇ  Searchable, read-only
‚îÇ  (colddb/)  ‚îÇ  Slower/cheaper storage OK
‚îÇ             ‚îÇ  Multiple cold buckets
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ frozenTimePeriodInSecs OR
       ‚îÇ maxTotalDataSizeMB
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   FROZEN    ‚îÇ  Archived or deleted
‚îÇ (optional)  ‚îÇ  Not searchable
‚îÇ             ‚îÇ  External archival
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</code></pre>
                
                <h3>Bucket Configuration</h3>
                
                <pre><code class="language-ini"># indexes.conf - Bucket settings

[security]
# Hot bucket settings
maxDataSize = auto
# auto = 750MB, auto_high_volume = 10GB

maxHotSpanSecs = 7776000
# Max time span in hot bucket (90 days default)

maxHotBuckets = 10
# Max number of hot buckets (for parallel indexing)

# Warm bucket settings  
maxWarmDBCount = 300
# Max warm buckets before rolling to cold

# Cold bucket settings (using different path)
coldPath = /slowstorage/security/colddb

# Frozen handling
coldToFrozenDir = /archive/security
# OR delete frozen data:
# coldToFrozenScript = /opt/splunk/bin/delete_frozen.sh</code></pre>
                
                <h3>Bucket Naming</h3>
                
                <pre><code class="language-text"># Bucket directory naming convention
db_&lt;newest_time&gt;_&lt;oldest_time&gt;_&lt;id&gt;_&lt;guid&gt;

# Example:
db_1705329000_1705242600_0_AAAAAAAA-BBBB-CCCC-DDDD-EEEEEEEEEEEE

# Contains:
rawdata/          # Compressed raw events
*.tsidx           # Time-series index files  
bloomfilter       # Bloom filter for quick lookups
Hosts.data        # Host metadata
Sources.data      # Source metadata
Sourcetypes.data  # Sourcetype metadata</code></pre>
                
                <h2 id="index-sizing">Index Sizing and Capacity Planning</h2>
                
                <h3>Estimating Storage Requirements</h3>
                
                <pre><code class="language-text"># Storage estimation formula
Daily_Indexed_Volume √ó Retention_Days √ó Compression_Factor = Storage_Required

# Example:
# 100 GB/day indexed
# 90 days retention
# 0.5 compression ratio (typical)

100 GB √ó 90 days √ó 0.5 = 4,500 GB = ~4.5 TB

# Add overhead:
# Raw data: 4.5 TB
# Indexes (tsidx): ~35% of raw = 1.575 TB
# Total: ~6 TB + 20% buffer = ~7.2 TB</code></pre>
                
                <h3>Sizing Queries</h3>
                
                <pre><code class="language-spl"># Current index sizes
| dbinspect index=* 
| stats sum(sizeOnDiskMB) AS totalMB by index
| eval totalGB = round(totalMB/1024, 2)
| sort -totalGB

# Index growth rate (daily)
index=_internal source=*license_usage.log type=Usage
| timechart span=1d sum(b) AS bytes by idx
| foreach * [eval &lt;&lt;FIELD&gt;&gt; = round('&lt;&lt;FIELD&gt;&gt;'/1024/1024/1024, 2)]

# Bucket count by index
| dbinspect index=*
| stats count by index, state
| chart sum(count) by index state

# Events per day by index
| tstats count WHERE index=* by index _time span=1d
| timechart span=1d sum(count) by index</code></pre>
                
                <h2 id="index-time-vs-search-time">Index-Time vs Search-Time</h2>
                
                <p>
                    Understanding when field extraction happens affects performance and storage:
                </p>
                
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Aspect</th>
                                <th>Index-Time</th>
                                <th>Search-Time</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>When occurs</strong></td>
                                <td>During data ingestion</td>
                                <td>During search execution</td>
                            </tr>
                            <tr>
                                <td><strong>Storage impact</strong></td>
                                <td>Increases index size</td>
                                <td>No storage impact</td>
                            </tr>
                            <tr>
                                <td><strong>Search speed</strong></td>
                                <td>Faster searches</td>
                                <td>Slower (extraction overhead)</td>
                            </tr>
                            <tr>
                                <td><strong>Flexibility</strong></td>
                                <td>Cannot change after indexing</td>
                                <td>Can modify anytime</td>
                            </tr>
                            <tr>
                                <td><strong>Use case</strong></td>
                                <td>Frequently searched fields</td>
                                <td>Rarely used fields</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <pre><code class="language-ini"># Index-time extraction (transforms.conf)
[extract_at_index]
REGEX = src_ip=(\d+\.\d+\.\d+\.\d+)
FORMAT = src_ip::$1
WRITE_META = true

# Apply in props.conf
[firewall]
TRANSFORMS-extract = extract_at_index

# Search-time extraction (props.conf)
[firewall]
EXTRACT-src_ip = src_ip=(?P&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)</code></pre>
                
                <h2 id="smartstore">SmartStore (S3 Backend)</h2>
                
                <p>
                    SmartStore enables storing cold/warm data in cloud object storage:
                </p>
                
                <pre><code class="language-ini"># indexes.conf - SmartStore configuration

[default]
# Global SmartStore settings
repFactor = auto

[volume:remote_store]
storageType = remote
path = s3://bucket-name/splunk-data
remote.s3.access_key = YOUR_ACCESS_KEY
remote.s3.secret_key = YOUR_SECRET_KEY
remote.s3.endpoint = https://s3.amazonaws.com

# Index using SmartStore
[security]
remotePath = volume:remote_store/security
homePath = $SPLUNK_DB/security/db
coldPath = $SPLUNK_DB/security/colddb
thawedPath = $SPLUNK_DB/security/thaweddb

# SmartStore cache settings
[cachemanager]
max_cache_size = 500000
# Local cache size in MB</code></pre>
                
                <div class="info-box tip">
                    <div class="info-box-header">
                        <span class="info-box-icon">üí°</span>
                        SmartStore Benefits
                    </div>
                    <div class="info-box-content">
                        <p>
                            <strong>1.</strong> Reduced local storage costs‚Äîuse cheap cloud storage for older data<br>
                            <strong>2.</strong> Elastic compute‚Äîadd indexers without migrating data<br>
                            <strong>3.</strong> Longer retention‚Äîcloud storage is much cheaper than local SSD<br>
                            <strong>4.</strong> Hot/warm data still on local fast storage for performance
                        </p>
                    </div>
                </div>
                
                <h2 id="index-design">Index Design Best Practices</h2>
                
                <pre><code class="language-text"># Recommended Index Structure for Security

security_windows    - Windows Security events (90 days)
security_linux      - Linux auth/audit logs (90 days)  
security_network    - Firewall, proxy, DNS (30-90 days)
security_cloud      - AWS/Azure/GCP audit (90 days)
security_endpoint   - EDR/AV logs (30-60 days)
security_notable    - SIEM-generated alerts (1+ year)

# Considerations:
1. Separate by retention requirement
2. Separate by data volume (high-volume = own index)
3. Separate by access control needs
4. Don't over-segment (too many indexes = complexity)</code></pre>
                
                <div class="info-box interview">
                    <div class="info-box-header">
                        <span class="info-box-icon">üíº</span>
                        Interview Question
                    </div>
                    <div class="info-box-content">
                        <p>
                            <strong>"Explain the Splunk bucket lifecycle. What happens when data ages?"</strong><br><br>
                            Data enters in <strong>hot</strong> buckets (writable, fastest storage). When hot buckets reach size/time limits, they roll to <strong>warm</strong> (read-only, same location). Warm rolls to <strong>cold</strong> when warm bucket count exceeds threshold (can be on slower storage). Cold eventually <strong>freezes</strong> when retention time/size limits are reached‚Äîdata is either deleted or archived externally. Only hot, warm, and cold are searchable; frozen data must be thawed to search.
                        </p>
                    </div>
                </div>
                
                <h2 id="summary">Chapter Summary</h2>
                
                <ul>
                    <li>Indexes store data with raw events, tsidx files, and bloom filters</li>
                    <li>Create indexes in indexes.conf with paths and retention settings</li>
                    <li>Retention controlled by frozenTimePeriodInSecs (time) and maxTotalDataSizeMB (size)</li>
                    <li>Buckets progress: Hot ‚Üí Warm ‚Üí Cold ‚Üí Frozen</li>
                    <li>Index-time extraction is faster to search but inflexible; search-time is flexible but slower</li>
                    <li>SmartStore enables cloud storage for cost-effective long-term retention</li>
                    <li>Design indexes based on retention, volume, and access requirements</li>
                </ul>
                
                <div class="page-navigation">
                    <a href="2-3-data-ingestion.html" class="nav-button prev">
                        <span class="nav-button-icon">‚Üê</span>
                        <div>
                            <span class="nav-button-label">Previous</span>
                            <span class="nav-button-title">Data Ingestion</span>
                        </div>
                    </a>
                    <a href="2-5-spl-fundamentals.html" class="nav-button next">
                        <span class="nav-button-icon">‚Üí</span>
                        <div>
                            <span class="nav-button-label">Next</span>
                            <span class="nav-button-title">SPL Fundamentals</span>
                        </div>
                    </a>
                </div>
            </div>
        </main>
    </div>
    
    <script src="main.js"></script>
</body>
</html>
